2025-06-19 17:10:52,700 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-19 17:10:52,701 - __main__ - INFO - Using database configuration from db_config.txt
2025-06-19 17:10:52,703 - parcel_filter.core.db_utils - INFO - Connected to PostgreSQL database
2025-06-19 17:11:01,770 - parcel_filter.core.filter - INFO - Found 10 unique power operators
2025-06-19 17:11:01,771 - parcel_filter.core.filter - INFO - Available operators in data: ['~unknown~', 'Arizona Public Service Company', 'California Independent System Operator', 'City of Mesa - (AZ)', 'Intermountain Power Service Corporation', 'Salt River Project', 'San Diego Gas & Electric', 'Southern California Edison', 'Tucson Electric Power Co.', 'Western Area Power Administration']
2025-06-19 17:11:22,809 - __main__ - INFO - Selected power provider: Intermountain Power Service Corporation
2025-06-19 17:11:22,809 - __main__ - INFO - Step 1: Loading parcels...
2025-06-19 17:11:23,714 - parcel_filter.core.filter - INFO - Unwanted activities columns: ['Land Use', 'Unwanted']
2025-06-19 17:11:23,716 - parcel_filter.core.filter - INFO - Unique values in 'Unwanted' column: [ True False]
2025-06-19 17:11:23,718 - parcel_filter.core.filter - INFO - Loaded 15 unwanted activities from Google Sheets
2025-06-19 17:11:29,954 - parcel_filter.core.filter - INFO - Parcel count in parcels_filtered_initial: 4533
2025-06-19 17:11:30,522 - parcel_filter.core.filter - INFO - Parcel count after initial filtering: 4533
2025-06-19 17:11:30,522 - parcel_filter.core.filter - INFO - Loaded 4533 parcels after initial filtering
2025-06-19 17:11:30,522 - __main__ - INFO - Step 2: Applying filters...
2025-06-19 17:11:30,522 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-06-19 17:11:30,893 - parcel_filter.core.filter - INFO - Created temporary parcels_filtered_airports_1750378290 with 4488 rows
2025-06-19 17:11:30,894 - parcel_filter.core.filter - INFO - Parcel count after airport filtering: 4488
2025-06-19 17:11:30,894 - parcel_filter.core.filter - INFO - After airport filtering: 4488 parcels
2025-06-19 17:11:30,894 - parcel_filter.core.filter - INFO - Filtering parcels based on transmission line distance...
2025-06-19 17:11:31,094 - parcel_filter.core.filter - INFO - Created temporary parcels_filtered_transmission_1750378290 with 2671 rows
2025-06-19 17:11:31,094 - parcel_filter.core.filter - INFO - Parcel count after transmission line filtering: 2671
2025-06-19 17:11:31,095 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Intermountain Power Service Corporation
2025-06-19 17:11:31,108 - parcel_filter.core.filter - INFO - Created temporary filtered_parcels_1750378291 with 26 rows
2025-06-19 17:11:31,109 - parcel_filter.core.filter - INFO - Parcel count after power operator filtering: 26
2025-06-19 17:11:31,109 - __main__ - INFO - Step 3: Calculating drive times...
2025-06-19 17:11:31,109 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-06-19 17:11:32,989 - parcel_filter.core.filter - INFO - Loaded 3 isochrone polygons
2025-06-19 17:11:32,989 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-06-19 17:11:35,689 - parcel_filter.core.filter - INFO - Drive time calculation completed
2025-06-19 17:11:35,695 - __main__ - INFO - Step 4: Ranking parcels...
2025-06-19 17:11:36,609 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-19 17:11:36,609 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.15, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-19 17:11:36,658 - parcel_filter.core.filter - INFO - Created permanent table results.az_maricopa_None_20250619_171136 with 26 rows
2025-06-19 17:11:36,673 - parcel_filter.core.filter - INFO - Table structure:
2025-06-19 17:11:36,678 - parcel_filter.core.filter - INFO - Sample row columns:
2025-06-19 17:11:36,811 - __main__ - INFO - Step 5: Saving results...
2025-06-19 17:11:36,812 - parcel_filter.core.filter - INFO - Results already saved to permanent table: results.az_maricopa_None_20250619_171136
2025-06-19 17:11:36,812 - __main__ - INFO - Step 6: Cleaning up temporary data...
2025-06-19 17:11:36,813 - parcel_filter.core.filter - INFO - Cleaned up temporary table: filtered_parcels_1750378291
2025-06-19 17:11:36,815 - __main__ - INFO - Pipeline completed successfully
2025-06-19 17:11:36,815 - __main__ - INFO - Loading ranked parcels from database table: results.az_maricopa_None_20250619_171136
2025-06-19 17:11:36,833 - parcel_filter.core.map_viewer - INFO - Converted date string column 'geoid' to string
2025-06-19 17:11:36,834 - parcel_filter.core.map_viewer - INFO - Converted date string column 'parcelnumb' to string
2025-06-19 17:11:36,835 - parcel_filter.core.map_viewer - INFO - Converted date string column 'parcelnumb_no_formatting' to string
2025-06-19 17:11:36,838 - parcel_filter.core.map_viewer - INFO - Converted date string column 'alt_parcelnumb1' to string
2025-06-19 17:11:36,840 - parcel_filter.core.map_viewer - INFO - Converted date string column 'usecode' to string
2025-06-19 17:11:36,842 - parcel_filter.core.map_viewer - INFO - Converted date column 'saledate' to string
2025-06-19 17:11:36,842 - parcel_filter.core.map_viewer - INFO - Converted date string column 'taxyear' to string
2025-06-19 17:11:36,844 - parcel_filter.core.map_viewer - INFO - Converted date string column 'mailadd' to string
2025-06-19 17:11:36,845 - parcel_filter.core.map_viewer - INFO - Converted date string column 'mail_address2' to string
2025-06-19 17:11:36,846 - parcel_filter.core.map_viewer - INFO - Converted date string column 'mail_unit' to string
2025-06-19 17:11:36,847 - parcel_filter.core.map_viewer - INFO - Converted date string column 'mail_zip' to string
2025-06-19 17:11:36,848 - parcel_filter.core.map_viewer - INFO - Converted date string column 'address' to string
2025-06-19 17:11:36,849 - parcel_filter.core.map_viewer - INFO - Converted date string column 'saddno' to string
2025-06-19 17:11:36,851 - parcel_filter.core.map_viewer - INFO - Converted date string column 'szip' to string
2025-06-19 17:11:36,852 - parcel_filter.core.map_viewer - INFO - Converted date string column 'szip5' to string
2025-06-19 17:11:36,856 - parcel_filter.core.map_viewer - INFO - Converted date string column 'legaldesc' to string
2025-06-19 17:11:36,856 - parcel_filter.core.map_viewer - INFO - Converted date string column 'book' to string
2025-06-19 17:11:36,857 - parcel_filter.core.map_viewer - INFO - Converted date string column 'lot' to string
2025-06-19 17:11:36,858 - parcel_filter.core.map_viewer - INFO - Converted date string column 'lat' to string
2025-06-19 17:11:36,859 - parcel_filter.core.map_viewer - INFO - Converted date string column 'lon' to string
2025-06-19 17:11:36,859 - parcel_filter.core.map_viewer - INFO - Converted date column 'fema_flood_zone_data_date' to string
2025-06-19 17:11:36,861 - parcel_filter.core.map_viewer - INFO - Converted date string column 'census_tract' to string
2025-06-19 17:11:36,863 - parcel_filter.core.map_viewer - INFO - Converted date string column 'census_block' to string
2025-06-19 17:11:36,864 - parcel_filter.core.map_viewer - INFO - Converted date string column 'census_blockgroup' to string
2025-06-19 17:11:36,865 - parcel_filter.core.map_viewer - INFO - Converted date string column 'census_zcta' to string
2025-06-19 17:11:36,866 - parcel_filter.core.map_viewer - INFO - Converted date column 'll_last_refresh' to string
2025-06-19 17:11:36,868 - parcel_filter.core.map_viewer - INFO - Converted date string column 'cdl_raw' to string
2025-06-19 17:11:36,869 - parcel_filter.core.map_viewer - INFO - Converted date string column 'cdl_date' to string
2025-06-19 17:11:36,871 - parcel_filter.core.map_viewer - INFO - Converted date string column 'plss_township' to string
2025-06-19 17:11:36,872 - parcel_filter.core.map_viewer - INFO - Converted date string column 'plss_section' to string
2025-06-19 17:11:36,873 - parcel_filter.core.map_viewer - INFO - Converted date string column 'plss_range' to string
2025-06-19 17:11:36,875 - parcel_filter.core.map_viewer - INFO - Converted date string column 'll_uuid' to string
2025-06-19 17:11:36,876 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-06-19 17:11:36,877 - parcel_filter.core.map_viewer - INFO - Converted date string column 'precisely_id' to string
2025-06-19 17:11:36,878 - parcel_filter.core.map_viewer - INFO - Converted date string column 'placekey' to string
2025-06-19 17:11:36,878 - parcel_filter.core.map_viewer - INFO - Converted date string column 'dpv_notes' to string
2025-06-19 17:11:36,879 - parcel_filter.core.map_viewer - INFO - Converted date string column 'cass_errorno' to string
2025-06-19 17:11:36,880 - parcel_filter.core.map_viewer - INFO - Converted date column 'usps_vacancy_date' to string
2025-06-19 17:11:36,881 - parcel_filter.core.map_viewer - INFO - Converted date string column 'map' to string
2025-06-19 17:11:36,882 - parcel_filter.core.map_viewer - INFO - Converted date string column 'mcrnumber' to string
2025-06-19 17:11:36,883 - parcel_filter.core.map_viewer - INFO - Converted date string column 'deednumber' to string
2025-06-19 17:11:36,883 - parcel_filter.core.map_viewer - INFO - Converted date column 'deeddate' to string
2025-06-19 17:11:36,885 - parcel_filter.core.map_viewer - INFO - Converted date string column 'apndash' to string
2025-06-19 17:11:36,887 - parcel_filter.core.map_viewer - INFO - Converted date string column 'landlegalclasscode' to string
2025-06-19 17:11:36,888 - parcel_filter.core.map_viewer - INFO - Converted date string column 'improvementlegalclasscode' to string
2025-06-19 17:11:36,889 - parcel_filter.core.map_viewer - INFO - Converted date string column 'taxingdistrictcode' to string
2025-06-19 17:11:36,892 - parcel_filter.core.map_viewer - INFO - Converted date string column 'item_number' to string
2025-06-19 17:11:36,893 - parcel_filter.core.map_viewer - INFO - Converted date string column 'et_kv' to string
2025-06-19 17:11:36,895 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 26
2025-06-19 17:11:36,948 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
   ogc_fid  geoid parcelnumb parcelnumb_no_formatting  ... flood_zone_ranking flood_subtype_ranking parcel_rank parcel_rank_normalized
0   558364  04013   50383036                 50383036  ...                0.0                   0.0    2.350505              10.000000
1  1620095  04013   50385035                 50385035  ...                0.0                   0.0    2.150000               9.126334
2  1505160  04013   50674005                 50674005  ...                0.0                   0.0    2.148292               9.118891
3   402695  04013  50469004A                50469004A  ...                0.0                   0.0    2.148099               9.118050
4   553328  04013  50471002A                50471002A  ...                0.0                   0.0    2.068243               8.770093

[5 rows x 229 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'map', 'mcrnumber', 'mcrweblink', 'deednumber', 'deeddate', 'rental', 'elementaryschooldistrict', 'highschooldistrict', 'apndash', 'limitedpropertyvalue', 'assessmentratio_pct', 'assessedfullcashvalue', 'assessedlimitedpropertyvalue', 'assessedlandfullcashvalue', 'assessedimprovementfullcashvalue', 'landlegalclasscode', 'landlegalclassdescription', 'improvementlegalclasscode', 'improvementlegalclassdescription', 'taxingdistrictcode', 'taxingdistrictdescription', 'floorlevel', 'exteriorwalltype', 'rooftype', 'bathfixtures', 'airconditioningtype', 'heat', 'coveredparkingspots', 'patios', 'pool', 'item_number', 'exemptstatus', 'exemptdescription', 'geom', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'drive_time', 'fb_name', 'fb_sub_oper', 'fb_operator', 'fb_owner', 'fb_type', 'fb_status', 'fb_service_type', 'fb_distance', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'zoning_ranking', 'zoning_subtype_ranking', 'activity_ranking', 'site_ranking', 'ownership_ranking', 'fema_nri_ranking', 'flood_zone_ranking', 'flood_subtype_ranking', 'parcel_rank', 'parcel_rank_normalized']
2025-06-19 17:11:36,949 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [-113.006282    33.551735  -112.457209    33.6967025]
2025-06-19 17:11:36,949 - parcel_filter.core.map_viewer - INFO - Map center: lat=33.62421875, lon=-112.73174549999999
2025-06-19 17:11:36,996 - parcel_filter.core.map_viewer - WARNING - Could not load substations: 'Engine' object has no attribute 'execute'
2025-06-19 17:11:37,077 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/az_maricopa_Intermountain Power Service Corporation_20250619_171136/az_maricopa_parcel_map.html
