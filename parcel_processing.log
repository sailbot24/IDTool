2025-07-29 18:48:16,387 - root - INFO - Virtual environment already exists. Skipping setup.
2025-07-29 18:48:16,387 - __main__ - INFO - Using database configuration from db_config.txt
2025-07-29 18:48:16,389 - parcel_filter.core.db_utils - INFO - Connected to PostgreSQL database
2025-07-29 18:48:16,435 - parcel_filter.core.filter - INFO - Found 2 available states: ['az', 'co']
2025-07-29 18:48:17,576 - __main__ - INFO - Selected state: az
2025-07-29 18:48:17,579 - parcel_filter.core.filter - INFO - Found 1 available counties for state az: ['maricopa']
2025-07-29 18:48:18,307 - __main__ - INFO - Selected county: maricopa
2025-07-29 18:48:18,308 - parcel_filter.core.db_utils - INFO - Connected to PostgreSQL database
2025-07-29 18:48:25,593 - parcel_filter.core.filter - INFO - Found 10 unique power operators
2025-07-29 18:48:25,593 - parcel_filter.core.filter - INFO - Available operators in data: ['~unknown~', 'Arizona Public Service Company', 'California Independent System Operator', 'City of Mesa - (AZ)', 'Intermountain Power Service Corporation', 'Salt River Project', 'San Diego Gas & Electric', 'Southern California Edison', 'Tucson Electric Power Co.', 'Western Area Power Administration']
2025-07-29 18:48:35,475 - __main__ - INFO - Selected power provider: Western Area Power Administration
2025-07-29 18:48:35,475 - __main__ - INFO - Step 1: Loading parcels...
2025-07-29 18:48:35,802 - parcel_filter.core.filter - INFO - Unwanted activities columns: ['Land Use', 'Unwanted']
2025-07-29 18:48:35,803 - parcel_filter.core.filter - INFO - Unique values in 'Unwanted' column: [ True False]
2025-07-29 18:48:35,804 - parcel_filter.core.filter - INFO - Loaded 17 unwanted activities from Google Sheets
2025-07-29 18:48:36,466 - parcel_filter.core.filter - INFO - Parcel count in parcels_filtered_initial: 4533
2025-07-29 18:48:36,672 - parcel_filter.core.filter - INFO - Parcel count after initial filtering: 4533
2025-07-29 18:48:36,672 - parcel_filter.core.filter - INFO - Loaded 4533 parcels after initial filtering
2025-07-29 18:48:36,672 - __main__ - INFO - Step 2: Applying filters...
2025-07-29 18:48:36,672 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-07-29 18:48:36,817 - parcel_filter.core.filter - INFO - Created temporary parcels_filtered_airports_1753807716 with 4488 rows
2025-07-29 18:48:36,817 - parcel_filter.core.filter - INFO - Parcel count after airport filtering: 4488
2025-07-29 18:48:36,817 - parcel_filter.core.filter - INFO - After airport filtering: 4488 parcels
2025-07-29 18:48:36,818 - parcel_filter.core.filter - INFO - Filtering parcels based on transmission line distance...
2025-07-29 18:48:36,900 - parcel_filter.core.filter - INFO - Created temporary parcels_filtered_transmission_1753807716 with 2671 rows
2025-07-29 18:48:36,900 - parcel_filter.core.filter - INFO - Parcel count after transmission line filtering: 2671
2025-07-29 18:48:36,901 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Western Area Power Administration
2025-07-29 18:48:36,908 - parcel_filter.core.filter - INFO - Created temporary filtered_parcels_1753807716 with 86 rows
2025-07-29 18:48:36,908 - parcel_filter.core.filter - INFO - Parcel count after power operator filtering: 86
2025-07-29 18:48:36,908 - __main__ - INFO - Step 3: Calculating drive times...
2025-07-29 18:48:36,908 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-07-29 18:48:37,711 - parcel_filter.core.filter - INFO - Loaded 3 isochrone polygons
2025-07-29 18:48:37,711 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-07-29 18:51:32,803 - parcel_filter.core.filter - INFO - Drive time calculation completed
2025-07-29 18:51:32,806 - __main__ - INFO - Step 4: Ranking parcels...
2025-07-29 18:51:33,403 - parcel_filter.core.mcda_ranking - INFO - Successfully loaded ranking data with 30 rows
2025-07-29 18:51:33,403 - parcel_filter.core.mcda_ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.15, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-07-29 18:51:33,417 - parcel_filter.core.mcda_ranking - INFO - Created all ranking lookup tables
2025-07-29 18:51:33,451 - parcel_filter.core.mcda_ranking - INFO - Created MCDA ranking table: results.az_maricopa_western_area_power_administration_20250729_185133
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO - MCDA Ranking Statistics:
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   Total parcels: 86
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   Min score: 0.00
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   Max score: 10.00
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   Mean score: 7.54
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   Median score: 9.09
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   Standard deviation: 2.23
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO - Top 5 parcels by MCDA ranking:
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   1. Parcel 50472029: Score 10.00
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Zoning: Planned
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Activity: Livestock related
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   2. Parcel 30401968A: Score 9.79
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Zoning: Special
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Activity: Shopping, business, or trade
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   3. Parcel 50406010D: Score 9.78
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Zoning: Planned
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Activity: Livestock related
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   4. Parcel 50384048C: Score 9.59
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Zoning: Planned
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Activity: Livestock related
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -   5. Parcel 50473005A: Score 9.37
2025-07-29 18:51:33,481 - parcel_filter.core.filter - INFO -      Zoning: Planned
2025-07-29 18:51:33,482 - parcel_filter.core.filter - INFO -      Activity: Livestock related
2025-07-29 18:51:33,485 - __main__ - INFO - Step 5: Saving results...
2025-07-29 18:51:33,485 - parcel_filter.core.filter - INFO - Results already saved to permanent table: results.az_maricopa_western_area_power_administration_20250729_185133
2025-07-29 18:51:33,485 - __main__ - INFO - Step 6: Cleaning up temporary data...
2025-07-29 18:51:33,485 - parcel_filter.core.filter - INFO - Cleaned up temporary table: filtered_parcels_1753807716
2025-07-29 18:51:33,487 - __main__ - INFO - PIPELINE COMPLETED SUCCESSFULLY
