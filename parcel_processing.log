2025-05-30 13:59:11,504 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 13:59:11,667 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-30 13:59:11,727 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-30 13:59:12,739 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 13:59:12,739 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 13:59:12,740 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_135912
2025-05-30 13:59:12,765 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_135912/weights_20250530_135912.json
2025-05-30 13:59:14,193 - pyogrio._io - INFO - Created 4,178 records
2025-05-30 13:59:14,205 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_135912/20250530_135912_ranked_parcels.gpkg
2025-05-30 13:59:42,806 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 13:59:42,807 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 13:59:42,807 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 13:59:42,807 - parcel_filter.core.ranking - INFO -   Mean score: 5.00
2025-05-30 13:59:42,814 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 13:59:42,815 - parcel_filter.core.ranking - INFO -   Parcel 40067020: Score 10.00
2025-05-30 13:59:42,815 - parcel_filter.core.ranking - INFO -   Parcel 40067019: Score 9.96
2025-05-30 13:59:42,815 - parcel_filter.core.ranking - INFO -   Parcel 40056004A: Score 9.66
2025-05-30 13:59:42,815 - parcel_filter.core.ranking - INFO -   Parcel 40066047A: Score 9.61
2025-05-30 13:59:42,815 - parcel_filter.core.ranking - INFO -   Parcel 50631005: Score 9.57
2025-05-30 13:59:42,815 - __main__ - INFO - Results saved in run_20250530_135912 directory
2025-05-30 13:59:42,815 - __main__ - INFO - Generating interactive map...
2025-05-30 13:59:42,815 - parcel_filter.core.map_viewer - INFO - Creating interactive map
2025-05-30 13:59:42,881 - parcel_filter.core.map_viewer - INFO - Number of parcels: 4178
2025-05-30 13:59:42,881 - parcel_filter.core.map_viewer - INFO - Sample normalized rank values: 0    5.357312
1    6.106088
2    5.680646
3    5.257400
4    5.299546
Name: parcel_rank_normalized, dtype: float64
2025-05-30 13:59:46,328 - parcel_filter.core.map_viewer - INFO - Interactive map saved to results/run_20250530_135912/az_maricopa_parcels_map.html
2025-05-30 13:59:46,335 - __main__ - INFO - Interactive map saved to results/run_20250530_135912/az_maricopa_parcels_map.html
2025-05-30 14:01:18,050 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:01:18,277 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-30 14:01:18,343 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-30 14:01:19,187 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 14:01:19,188 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 14:01:19,188 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_140119
2025-05-30 14:01:19,228 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_140119/weights_20250530_140119.json
2025-05-30 14:01:19,640 - pyogrio._io - INFO - Created 4,178 records
2025-05-30 14:01:19,653 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_140119/20250530_140119_ranked_parcels.gpkg
2025-05-30 14:01:30,425 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 14:01:30,425 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 14:01:30,425 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 14:01:30,425 - parcel_filter.core.ranking - INFO -   Mean score: 5.00
2025-05-30 14:01:30,435 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 14:01:30,436 - parcel_filter.core.ranking - INFO -   Parcel 40067020: Score 10.00
2025-05-30 14:01:30,437 - parcel_filter.core.ranking - INFO -   Parcel 40067019: Score 9.96
2025-05-30 14:01:30,437 - parcel_filter.core.ranking - INFO -   Parcel 40056004A: Score 9.66
2025-05-30 14:01:30,437 - parcel_filter.core.ranking - INFO -   Parcel 40066047A: Score 9.61
2025-05-30 14:01:30,437 - parcel_filter.core.ranking - INFO -   Parcel 50631005: Score 9.57
2025-05-30 14:01:30,437 - __main__ - INFO - Results saved in run_20250530_140119 directory
2025-05-30 14:01:30,437 - __main__ - INFO - Generating interactive map...
2025-05-30 14:01:30,437 - parcel_filter.core.map_viewer - INFO - Creating interactive map
2025-05-30 14:01:30,512 - parcel_filter.core.map_viewer - INFO - Number of parcels: 4178
2025-05-30 14:01:30,513 - parcel_filter.core.map_viewer - INFO - Sample normalized rank values: 0    5.357312
1    6.106088
2    5.680646
3    5.257400
4    5.299546
Name: parcel_rank_normalized, dtype: float64
2025-05-30 14:01:34,028 - parcel_filter.core.map_viewer - INFO - Interactive map saved to results/run_20250530_140119/az_maricopa_parcels_map.html
2025-05-30 14:01:34,035 - __main__ - INFO - Interactive map saved to results/run_20250530_140119/az_maricopa_parcels_map.html
2025-05-30 14:11:31,691 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:11:31,717 - __main__ - ERROR - Error processing parcels: IO Error: Could not set lock on file "/Users/gavin/Desktop/Personal/Adams Geospatial/Data/Garrison/IDTool/data/LandAI.ddb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 594) by user gavin. See also https://duckdb.org/docs/stable/connect/concurrency
2025-05-30 14:11:40,223 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:11:40,426 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-30 14:11:40,493 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-30 14:11:41,914 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 14:11:41,914 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 14:11:41,915 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_141141
2025-05-30 14:11:41,945 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_141141/weights_20250530_141141.json
2025-05-30 14:11:42,342 - pyogrio._io - INFO - Created 4,178 records
2025-05-30 14:11:42,355 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_141141/20250530_141141_ranked_parcels.gpkg
2025-05-30 14:11:50,625 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 14:11:50,625 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 14:11:50,626 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 14:11:50,626 - parcel_filter.core.ranking - INFO -   Mean score: 5.00
2025-05-30 14:11:50,638 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 14:11:50,640 - parcel_filter.core.ranking - INFO -   Parcel 40067020: Score 10.00
2025-05-30 14:11:50,640 - parcel_filter.core.ranking - INFO -   Parcel 40067019: Score 9.96
2025-05-30 14:11:50,640 - parcel_filter.core.ranking - INFO -   Parcel 40056004A: Score 9.66
2025-05-30 14:11:50,640 - parcel_filter.core.ranking - INFO -   Parcel 40066047A: Score 9.61
2025-05-30 14:11:50,640 - parcel_filter.core.ranking - INFO -   Parcel 50631005: Score 9.57
2025-05-30 14:11:50,640 - __main__ - INFO - Results saved in run_20250530_141141 directory
2025-05-30 14:11:50,640 - __main__ - INFO - Generating interactive map...
2025-05-30 14:11:50,640 - parcel_filter.core.map_viewer - INFO - Creating interactive map
2025-05-30 14:11:50,720 - parcel_filter.core.map_viewer - INFO - Number of parcels: 4178
2025-05-30 14:11:50,721 - parcel_filter.core.map_viewer - INFO - Sample normalized rank values: 0    5.357312
1    6.106088
2    5.680646
3    5.257400
4    5.299546
Name: parcel_rank_normalized, dtype: float64
2025-05-30 14:11:54,195 - parcel_filter.core.map_viewer - INFO - Interactive map saved to results/run_20250530_141141/az_maricopa_parcels_map.html
2025-05-30 14:11:54,202 - __main__ - INFO - Interactive map saved to results/run_20250530_141141/az_maricopa_parcels_map.html
2025-05-30 14:12:02,258 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:12:02,366 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:12:02,366 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:12:02,368 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "geometry" in EXCLUDE list not found in FROM clause
2025-05-30 14:12:02,371 - __main__ - ERROR - Error processing parcels: Binder Error: Column "geometry" in EXCLUDE list not found in FROM clause
2025-05-30 14:24:42,152 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:24:42,359 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:24:42,359 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:24:43,014 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 2:             SELECT *, ST_AsText(geom) as geom_wkt FROM (SELECT * FROM parcels_fil...
                              ^
2025-05-30 14:24:43,084 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 2:             SELECT *, ST_AsText(geom) as geom_wkt FROM (SELECT * FROM parcels_fil...
                              ^
2025-05-30 14:26:12,538 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:26:12,650 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:26:12,650 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:26:13,287 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 2:             SELECT *, ST_AsText(geom) as geom_wkt 
                              ^
2025-05-30 14:26:13,356 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 2:             SELECT *, ST_AsText(geom) as geom_wkt 
                              ^
2025-05-30 14:26:53,605 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:26:53,719 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:26:53,719 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:26:54,315 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 2:             SELECT *, ST_AsText(geom) as geom_wkt 
                              ^
2025-05-30 14:26:54,376 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 2:             SELECT *, ST_AsText(geom) as geom_wkt 
                              ^
2025-05-30 14:29:01,166 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:29:01,189 - __main__ - ERROR - Error processing parcels: IO Error: Could not set lock on file "/Users/gavin/Desktop/Personal/Adams Geospatial/Data/Garrison/IDTool/data/LandAI.ddb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 594) by user gavin. See also https://duckdb.org/docs/stable/connect/concurrency
2025-05-30 14:29:11,512 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:29:11,677 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:29:11,677 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:29:12,314 - parcel_filter.core.filter - ERROR - Error loading parcels: Expected bytes or string, got bytearray
2025-05-30 14:29:12,377 - __main__ - ERROR - Error processing parcels: Expected bytes or string, got bytearray
2025-05-30 14:29:40,556 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:29:40,647 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:29:40,647 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:29:41,177 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:29:41,177 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:29:41,179 - parcel_filter.core.filter - ERROR - Error filtering airports: Binder Error: No function matches the given name and argument types 'ST_Intersects(WKB_BLOB, GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Intersects(BOX_2D, BOX_2D) -> BOOLEAN
	ST_Intersects(GEOMETRY, GEOMETRY) -> BOOLEAN


LINE 8:                     ON ST_Intersects(p.geom, a.geom)
                               ^
2025-05-30 14:29:41,221 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_Intersects(WKB_BLOB, GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Intersects(BOX_2D, BOX_2D) -> BOOLEAN
	ST_Intersects(GEOMETRY, GEOMETRY) -> BOOLEAN


LINE 8:                     ON ST_Intersects(p.geom, a.geom)
                               ^
2025-05-30 14:30:18,650 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:30:18,741 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:30:18,741 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:30:19,254 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:30:19,254 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:30:19,388 - parcel_filter.core.filter - INFO - After airport filtering: 4178 parcels
2025-05-30 14:30:19,388 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 14:30:19,417 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 14:30:19,501 - parcel_filter.core.filter - INFO - After transmission line filtering: 2496 parcels
2025-05-30 14:30:19,502 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 14:30:19,521 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 14:30:19,521 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 14:30:19,534 - parcel_filter.core.filter - ERROR - Error calculating drive times: Binder Error: No function matches the given name and argument types 'ST_Force2D(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Force2D(GEOMETRY) -> GEOMETRY


LINE 12:                     ST_Force2D(p.geom) as geom,
                             ^
2025-05-30 14:30:19,967 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_Force2D(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Force2D(GEOMETRY) -> GEOMETRY


LINE 12:                     ST_Force2D(p.geom) as geom,
                             ^
2025-05-30 14:30:56,636 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:30:56,726 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:30:56,726 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:30:57,237 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:30:57,237 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:30:57,360 - parcel_filter.core.filter - INFO - After airport filtering: 4178 parcels
2025-05-30 14:30:57,361 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 14:30:57,389 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 14:30:57,473 - parcel_filter.core.filter - INFO - After transmission line filtering: 2496 parcels
2025-05-30 14:30:57,473 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 14:30:57,490 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 14:30:57,490 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 14:30:57,564 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 14:30:57,630 - parcel_filter.core.filter - ERROR - Error calculating drive times: ParseException: Input buffer is smaller than requested object size
2025-05-30 14:30:58,156 - __main__ - ERROR - Error processing parcels: ParseException: Input buffer is smaller than requested object size
2025-05-30 14:31:33,852 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:31:33,942 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:31:33,942 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:31:34,468 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:31:34,468 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:31:34,592 - parcel_filter.core.filter - INFO - After airport filtering: 4178 parcels
2025-05-30 14:31:34,593 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 14:31:34,620 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 14:31:34,706 - parcel_filter.core.filter - INFO - After transmission line filtering: 2496 parcels
2025-05-30 14:31:34,706 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 14:31:34,723 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 14:31:34,723 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 14:31:34,760 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 14:31:35,977 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 14:31:35,977 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 14:31:35,978 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_143135
2025-05-30 14:31:36,013 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_143135/weights_20250530_143135.json
2025-05-30 14:31:36,551 - __main__ - ERROR - Error processing parcels: No geometry column found in parcels DataFrame
2025-05-30 14:32:09,497 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:32:09,587 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:32:09,588 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:32:10,118 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:32:10,118 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:32:10,254 - parcel_filter.core.filter - INFO - After airport filtering: 4178 parcels
2025-05-30 14:32:10,254 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 14:32:10,282 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 14:32:10,371 - parcel_filter.core.filter - INFO - After transmission line filtering: 2496 parcels
2025-05-30 14:32:10,371 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 14:32:10,388 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 14:32:10,388 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 14:32:10,424 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 14:32:11,078 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 14:32:11,078 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 14:32:11,078 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_143211
2025-05-30 14:32:11,100 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_143211/weights_20250530_143211.json
2025-05-30 14:32:11,617 - __main__ - ERROR - Error processing parcels: No geometry column found in parcels DataFrame
2025-05-30 14:32:46,065 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:32:46,159 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:32:46,159 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:32:46,711 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:32:46,711 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:32:46,843 - parcel_filter.core.filter - INFO - After airport filtering: 4178 parcels
2025-05-30 14:32:46,843 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 14:32:46,872 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 14:32:47,002 - parcel_filter.core.filter - INFO - After transmission line filtering: 2496 parcels
2025-05-30 14:32:47,003 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 14:32:47,019 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 14:32:47,019 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 14:32:47,056 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 14:32:47,710 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 14:32:47,710 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 14:32:47,711 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_143247
2025-05-30 14:32:47,741 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_143247/weights_20250530_143247.json
2025-05-30 14:32:48,399 - __main__ - ERROR - Error processing parcels: Error adding field 'geom' to layer
2025-05-30 14:33:11,295 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:33:11,385 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:33:11,385 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:33:11,906 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:33:11,906 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:33:12,033 - parcel_filter.core.filter - INFO - After airport filtering: 4178 parcels
2025-05-30 14:33:12,033 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 14:33:12,061 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 14:33:12,149 - parcel_filter.core.filter - INFO - After transmission line filtering: 2496 parcels
2025-05-30 14:33:12,149 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 14:33:12,166 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 14:33:12,166 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 14:33:12,203 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 14:33:13,025 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 14:33:13,025 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 14:33:13,026 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_143313
2025-05-30 14:33:13,057 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_143313/weights_20250530_143313.json
2025-05-30 14:33:13,313 - pyogrio._io - INFO - Created 2,496 records
2025-05-30 14:33:13,321 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_143313/20250530_143313_ranked_parcels.gpkg
2025-05-30 14:33:46,855 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 14:33:46,855 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 14:33:46,856 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 14:33:46,856 - parcel_filter.core.ranking - INFO -   Mean score: 5.08
2025-05-30 14:33:46,868 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 14:33:46,870 - parcel_filter.core.ranking - INFO -   Parcel 40205015C: Score 10.00
2025-05-30 14:33:46,870 - parcel_filter.core.ranking - INFO -   Parcel 40315050B: Score 9.73
2025-05-30 14:33:46,870 - parcel_filter.core.ranking - INFO -   Parcel 40221011Z: Score 9.59
2025-05-30 14:33:46,870 - parcel_filter.core.ranking - INFO -   Parcel 40316012L: Score 9.35
2025-05-30 14:33:46,870 - parcel_filter.core.ranking - INFO -   Parcel 40345034S: Score 9.23
2025-05-30 14:33:46,870 - __main__ - INFO - Results saved in run_20250530_143313 directory
2025-05-30 14:33:46,870 - __main__ - INFO - Generating interactive map...
2025-05-30 14:33:46,871 - parcel_filter.core.map_viewer - INFO - Creating interactive map
2025-05-30 14:33:46,938 - parcel_filter.core.map_viewer - INFO - Number of parcels: 2496
2025-05-30 14:33:46,938 - parcel_filter.core.map_viewer - INFO - Sample normalized rank values: 0    4.361759
1    4.873368
2    5.140735
3    5.269391
4    4.689553
Name: parcel_rank_normalized, dtype: float64
2025-05-30 14:33:49,381 - parcel_filter.core.map_viewer - INFO - Interactive map saved to results/run_20250530_143313/az_maricopa_parcels_map.html
2025-05-30 14:33:49,385 - __main__ - INFO - Interactive map saved to results/run_20250530_143313/az_maricopa_parcels_map.html
2025-05-30 14:35:44,458 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:35:44,657 - __main__ - INFO - Force flag set, running full pipeline
2025-05-30 14:35:44,657 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:35:45,339 - parcel_filter.core.filter - INFO - Loaded 4222 parcels after initial filtering
2025-05-30 14:35:45,339 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 14:35:45,478 - parcel_filter.core.filter - INFO - After airport filtering: 4178 parcels
2025-05-30 14:35:45,478 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 14:35:45,513 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 14:35:45,605 - parcel_filter.core.filter - INFO - After transmission line filtering: 2496 parcels
2025-05-30 14:35:45,605 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 14:35:45,624 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 14:35:45,624 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 14:35:45,666 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 14:35:46,318 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 14:35:46,319 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 14:35:46,319 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_143546
2025-05-30 14:35:46,352 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_143546/weights_20250530_143546.json
2025-05-30 14:35:46,669 - pyogrio._io - INFO - Created 2,496 records
2025-05-30 14:35:46,680 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_143546/20250530_143546_ranked_parcels.gpkg
2025-05-30 14:35:49,562 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 14:35:49,563 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 14:35:49,563 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 14:35:49,563 - parcel_filter.core.ranking - INFO -   Mean score: 5.08
2025-05-30 14:35:49,572 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 14:35:49,574 - parcel_filter.core.ranking - INFO -   Parcel 40205015C: Score 10.00
2025-05-30 14:35:49,574 - parcel_filter.core.ranking - INFO -   Parcel 40315050B: Score 9.73
2025-05-30 14:35:49,574 - parcel_filter.core.ranking - INFO -   Parcel 40221011Z: Score 9.59
2025-05-30 14:35:49,575 - parcel_filter.core.ranking - INFO -   Parcel 40316012L: Score 9.35
2025-05-30 14:35:49,575 - parcel_filter.core.ranking - INFO -   Parcel 40345034S: Score 9.23
2025-05-30 14:35:49,575 - __main__ - INFO - Results saved in run_20250530_143546 directory
2025-05-30 14:35:49,575 - __main__ - INFO - Generating interactive map...
2025-05-30 14:35:49,575 - parcel_filter.core.map_viewer - INFO - Creating interactive map
2025-05-30 14:35:49,632 - parcel_filter.core.map_viewer - INFO - Number of parcels: 2496
2025-05-30 14:35:49,632 - parcel_filter.core.map_viewer - INFO - Sample normalized rank values: 0    4.361759
1    4.873368
2    5.140735
3    5.269391
4    4.689553
Name: parcel_rank_normalized, dtype: float64
2025-05-30 14:35:49,962 - parcel_filter.core.map_viewer - ERROR - Error adding rextag layers: IO Error: Cannot open file "/Users/gavin/Desktop/Personal/Adams Geospatial/Data/Garrison/IDTool/duckdb_database/parcels.duckdb": No such file or directory
2025-05-30 14:35:51,960 - parcel_filter.core.map_viewer - INFO - Interactive map saved to results/run_20250530_143546/az_maricopa_parcels_map.html
2025-05-30 14:35:51,965 - __main__ - INFO - Interactive map saved to results/run_20250530_143546/az_maricopa_parcels_map.html
2025-05-30 14:43:45,275 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:43:45,322 - __main__ - ERROR - Error processing parcels: IO Error: Could not set lock on file "/Users/gavin/Desktop/Personal/Adams Geospatial/Data/Garrison/IDTool/data/LandAI.ddb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 594) by user gavin. See also https://duckdb.org/docs/stable/connect/concurrency
2025-05-30 14:46:49,921 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:46:50,152 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 14:46:50,152 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:46:50,163 - parcel_filter.core.filter - ERROR - Error converting geometry column in parcels_filtered_initial: 'NoneType' object is not subscriptable
2025-05-30 14:46:50,164 - parcel_filter.core.filter - ERROR - Error loading parcels: 'NoneType' object is not subscriptable
2025-05-30 14:46:50,170 - __main__ - ERROR - Error processing parcels: 'NoneType' object is not subscriptable
2025-05-30 14:58:39,955 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:58:40,209 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 14:58:40,209 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:58:40,226 - parcel_filter.core.filter - ERROR - Error converting geometry column in parcels_filtered_initial: 'NoneType' object is not subscriptable
2025-05-30 14:58:40,227 - parcel_filter.core.filter - ERROR - Error loading parcels: 'NoneType' object is not subscriptable
2025-05-30 14:58:40,232 - __main__ - ERROR - Error processing parcels: 'NoneType' object is not subscriptable
2025-05-30 14:59:27,994 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 14:59:28,165 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 14:59:28,165 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 14:59:28,178 - parcel_filter.core.filter - ERROR - Error converting geometry column in parcels_filtered_initial: 'NoneType' object is not subscriptable
2025-05-30 14:59:28,178 - parcel_filter.core.filter - ERROR - Error loading parcels: 'NoneType' object is not subscriptable
2025-05-30 14:59:28,183 - __main__ - ERROR - Error processing parcels: 'NoneType' object is not subscriptable
2025-05-30 15:01:29,898 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:01:30,084 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:01:30,084 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:01:30,093 - parcel_filter.core.filter - ERROR - Error converting geometry column in parcels_filtered_initial: No rows found in table parcels_filtered_initial
2025-05-30 15:01:30,094 - parcel_filter.core.filter - ERROR - Error loading parcels: No rows found in table parcels_filtered_initial
2025-05-30 15:01:30,099 - __main__ - ERROR - Error processing parcels: No rows found in table parcels_filtered_initial
2025-05-30 15:07:08,858 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:07:09,124 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:07:09,124 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:07:09,544 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-30 15:07:09,627 - parcel_filter.core.filter - ERROR - Error loading parcels: ParseException: Input buffer is smaller than requested object size
2025-05-30 15:07:09,640 - __main__ - ERROR - Error processing parcels: ParseException: Input buffer is smaller than requested object size
2025-05-30 15:07:56,214 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:07:56,366 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:07:56,366 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:07:56,687 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-30 15:07:56,748 - parcel_filter.core.filter - ERROR - Error loading parcels: ParseException: Input buffer is smaller than requested object size
2025-05-30 15:07:56,762 - __main__ - ERROR - Error processing parcels: ParseException: Input buffer is smaller than requested object size
2025-05-30 15:15:37,741 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:15:38,000 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:15:38,001 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:15:38,413 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-30 15:15:38,506 - parcel_filter.core.filter - ERROR - Error loading parcels: ParseException: Input buffer is smaller than requested object size
2025-05-30 15:15:38,518 - __main__ - ERROR - Error processing parcels: ParseException: Input buffer is smaller than requested object size
2025-05-30 15:16:33,457 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:16:33,609 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:16:33,609 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:16:33,971 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-30 15:16:33,981 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 4:                 ST_AsText(ST_GeomFromWKB(geom)) AS geom_wkt
                                  ^
2025-05-30 15:16:33,993 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 4:                 ST_AsText(ST_GeomFromWKB(geom)) AS geom_wkt
                                  ^
2025-05-30 15:17:09,326 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:17:09,483 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:17:09,483 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:17:09,806 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-30 15:17:09,958 - parcel_filter.core.filter - INFO - Loaded 2123 parcels after initial filtering
2025-05-30 15:17:09,958 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 15:17:09,960 - parcel_filter.core.filter - ERROR - Error filtering airports: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 8:                     ON ST_Intersects(ST_GeomFromWKB(p.geom), a.geom)
                                             ^
2025-05-30 15:17:09,973 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 8:                     ON ST_Intersects(ST_GeomFromWKB(p.geom), a.geom)
                                             ^
2025-05-30 15:17:46,904 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:17:47,059 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:17:47,059 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:17:47,383 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-30 15:17:47,521 - parcel_filter.core.filter - INFO - Loaded 2123 parcels after initial filtering
2025-05-30 15:17:47,521 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 15:17:47,675 - parcel_filter.core.filter - INFO - After airport filtering: 2094 parcels
2025-05-30 15:17:47,675 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 15:17:47,702 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 15:17:47,796 - parcel_filter.core.filter - INFO - After transmission line filtering: 1144 parcels
2025-05-30 15:17:47,796 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 15:17:47,829 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 15:17:47,829 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 15:17:47,838 - parcel_filter.core.filter - ERROR - Error calculating drive times: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 13:                         ST_GeomFromWKB(p.geom) as geom_2d
                                 ^
2025-05-30 15:17:48,463 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 13:                         ST_GeomFromWKB(p.geom) as geom_2d
                                 ^
2025-05-30 15:18:18,104 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:18:18,263 - parcel_filter.core.filter - INFO - Loading checkpoint: transmission_filtered_100m
2025-05-30 15:18:18,293 - __main__ - INFO - Loaded transmission line checkpoint, skipping to drive time calculation
2025-05-30 15:18:18,404 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 15:18:18,432 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 15:18:18,433 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 15:18:18,468 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 15:18:19,506 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 15:18:19,507 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 15:18:19,507 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_151819
2025-05-30 15:18:19,536 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_151819/weights_20250530_151819.json
2025-05-30 15:18:19,813 - pyogrio._io - INFO - Created 1,144 records
2025-05-30 15:18:19,821 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_151819/20250530_151819_ranked_parcels.gpkg
2025-05-30 15:19:01,825 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 15:19:01,825 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 15:19:01,825 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 15:19:01,825 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-05-30 15:19:01,830 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 15:19:01,831 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-05-30 15:19:01,831 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-05-30 15:19:01,831 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-05-30 15:19:01,831 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-05-30 15:19:01,831 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-05-30 15:19:01,831 - __main__ - INFO - Results saved in run_20250530_151819 directory
2025-05-30 15:19:58,645 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:19:58,804 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-30 15:19:58,804 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-30 15:19:59,481 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-30 15:20:00,528 - parcel_filter.core.filter - INFO - Loaded 19346 parcels after initial filtering
2025-05-30 15:20:00,529 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-30 15:20:01,882 - parcel_filter.core.filter - INFO - After airport filtering: 19229 parcels
2025-05-30 15:20:01,882 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-30 15:20:02,002 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-30 15:20:03,211 - parcel_filter.core.filter - INFO - After transmission line filtering: 8004 parcels
2025-05-30 15:20:03,211 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-30 15:20:03,239 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-30 15:20:03,239 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-30 15:20:03,332 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-30 15:20:04,996 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 15:20:04,996 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 15:20:04,997 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_152004
2025-05-30 15:20:05,044 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_152004/weights_20250530_152005.json
2025-05-30 15:20:06,245 - pyogrio._io - INFO - Created 8,004 records
2025-05-30 15:20:06,274 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_152004/20250530_152004_ranked_parcels.gpkg
2025-05-30 15:20:18,994 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 15:20:18,994 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 15:20:18,994 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 15:20:18,994 - parcel_filter.core.ranking - INFO -   Mean score: 6.71
2025-05-30 15:20:19,015 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 15:20:19,015 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-30 15:20:19,016 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.82
2025-05-30 15:20:19,016 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.81
2025-05-30 15:20:19,016 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.81
2025-05-30 15:20:19,016 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.81
2025-05-30 15:20:19,016 - __main__ - INFO - Results saved in run_20250530_152004 directory
2025-05-30 15:20:19,016 - __main__ - INFO - Generating interactive map...
2025-05-30 15:20:19,016 - parcel_filter.core.map_viewer - INFO - Creating interactive map
2025-05-30 15:20:19,202 - parcel_filter.core.map_viewer - INFO - Number of parcels: 8004
2025-05-30 15:20:19,202 - parcel_filter.core.map_viewer - INFO - Sample normalized rank values: 0    6.552741
1    5.760640
2    5.760640
3    8.236102
4    6.477835
Name: parcel_rank_normalized, dtype: float64
2025-05-30 15:20:20,241 - parcel_filter.core.map_viewer - ERROR - Error adding rextag layers: IO Error: Cannot open file "/Users/gavin/Desktop/Personal/Adams Geospatial/Data/Garrison/IDTool/duckdb_database/parcels.duckdb": No such file or directory
2025-05-30 15:20:29,079 - parcel_filter.core.map_viewer - INFO - Interactive map saved to results/run_20250530_152004/co_weld_parcels_map.html
2025-05-30 15:20:29,102 - __main__ - INFO - Interactive map saved to results/run_20250530_152004/co_weld_parcels_map.html
2025-05-30 15:24:29,093 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:24:29,363 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-30 15:24:29,402 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-30 15:24:30,148 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 15:24:30,149 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 15:24:30,149 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_152430
2025-05-30 15:24:30,178 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_152430/weights_20250530_152430.json
2025-05-30 15:24:30,455 - pyogrio._io - INFO - Created 1,144 records
2025-05-30 15:24:30,463 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_152430/20250530_152430_ranked_parcels.gpkg
2025-05-30 15:27:58,485 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 15:27:58,679 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-30 15:27:58,709 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-30 15:27:59,480 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 15:27:59,480 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 15:27:59,480 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_152759
2025-05-30 15:27:59,506 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_152759/weights_20250530_152759.json
2025-05-30 15:27:59,717 - pyogrio._io - INFO - Created 1,144 records
2025-05-30 15:27:59,724 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_152759/20250530_152759_ranked_parcels.gpkg
2025-05-30 15:28:04,458 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 15:28:04,458 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 15:28:04,458 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 15:28:04,458 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-05-30 15:28:04,463 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 15:28:04,465 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-05-30 15:28:04,465 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-05-30 15:28:04,466 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-05-30 15:28:04,466 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-05-30 15:28:04,466 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-05-30 15:28:04,466 - __main__ - INFO - Results saved in run_20250530_152759 directory
2025-05-30 15:28:04,466 - __main__ - INFO - Generating interactive map...
2025-05-30 15:28:04,468 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-30 15:28:04,469 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-30 15:28:04,470 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-30 15:28:04,470 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-30 15:28:04,480 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-30 15:28:04,481 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-30 15:28:04,482 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-30 15:28:04,483 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-30 15:28:04,483 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-30 15:28:04,507 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-30 15:28:05,805 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250530_152759/co_adams_parcel_map.html
2025-05-30 16:04:38,921 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 16:04:38,950 - __main__ - ERROR - Error processing parcels: IO Error: Could not set lock on file "/Users/gavin/Desktop/Personal/Adams Geospatial/Data/Garrison/IDTool/data/LandAI.ddb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 594) by user gavin. See also https://duckdb.org/docs/stable/connect/concurrency
2025-05-30 16:04:49,157 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 16:04:49,371 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-05-30 16:04:55,876 - __main__ - INFO - Selected power provider: Xcel
2025-05-30 16:04:55,904 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-30 16:04:55,940 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-30 16:04:57,544 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 16:04:57,545 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 16:04:57,546 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_160457
2025-05-30 16:04:57,570 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_160457/weights_20250530_160457.json
2025-05-30 16:04:57,827 - pyogrio._io - INFO - Created 1,144 records
2025-05-30 16:04:57,834 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_160457/20250530_160457_ranked_parcels.gpkg
2025-05-30 16:05:22,268 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 16:05:22,268 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 16:05:22,268 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 16:05:22,268 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-05-30 16:05:22,276 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 16:05:22,277 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-05-30 16:05:22,277 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-05-30 16:05:22,277 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-05-30 16:05:22,277 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-05-30 16:05:22,277 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-05-30 16:05:22,277 - __main__ - INFO - Results saved in run_20250530_160457 directory
2025-05-30 16:05:31,006 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-30 16:05:31,153 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-05-30 16:05:48,758 - __main__ - INFO - Selected power provider: Xcel
2025-05-30 16:05:48,784 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-30 16:05:48,820 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-30 16:05:49,777 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-30 16:05:49,777 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-30 16:05:49,777 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250530_160549
2025-05-30 16:05:49,802 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250530_160549/weights_20250530_160549.json
2025-05-30 16:05:50,003 - pyogrio._io - INFO - Created 1,144 records
2025-05-30 16:05:50,010 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250530_160549/20250530_160549_ranked_parcels.gpkg
2025-05-30 16:06:18,913 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-30 16:06:18,914 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-30 16:06:18,914 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-30 16:06:18,914 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-05-30 16:06:18,921 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-30 16:06:18,922 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-05-30 16:06:18,922 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-05-30 16:06:18,922 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-05-30 16:06:18,922 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-05-30 16:06:18,922 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-05-30 16:06:18,922 - __main__ - INFO - Results saved in run_20250530_160549 directory
2025-05-31 09:30:58,230 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:30:58,519 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-05-31 09:31:02,198 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:31:02,244 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:31:02,244 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:31:02,244 - parcel_filter.core.filter - ERROR - Error loading parcels: cannot access local variable 'table_name' where it is not associated with a value
2025-05-31 09:31:02,251 - __main__ - ERROR - Error processing parcels: cannot access local variable 'table_name' where it is not associated with a value
2025-05-31 09:32:35,994 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:32:36,278 - parcel_filter.core.filter - ERROR - Error getting power providers: name 'c' is not defined
2025-05-31 09:32:36,284 - __main__ - ERROR - Error processing parcels: name 'c' is not defined
2025-05-31 09:39:06,307 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:39:06,578 - parcel_filter.core.filter - ERROR - Error getting power providers: name 'st' is not defined
2025-05-31 09:39:06,583 - __main__ - ERROR - Error processing parcels: name 'st' is not defined
2025-05-31 09:39:49,290 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:39:49,589 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:39:56,686 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:39:56,717 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:39:56,718 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:39:56,718 - parcel_filter.core.filter - ERROR - Error loading parcels: name 'st' is not defined
2025-05-31 09:39:56,726 - __main__ - ERROR - Error processing parcels: name 'st' is not defined
2025-05-31 09:40:37,187 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:40:37,392 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:40:39,174 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:40:39,203 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:40:39,203 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:40:39,220 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 09:40:39,225 - __main__ - ERROR - Error processing parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 09:41:57,103 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:41:57,399 - parcel_filter.core.filter - INFO - Found 11 unique power providers
2025-05-31 09:41:59,533 - __main__ - INFO - Selected power provider: Western
2025-05-31 09:41:59,565 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:41:59,566 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:42:01,289 - parcel_filter.core.filter - INFO - Converting geometry column in parcels_filtered_initial from WKB_BLOB to GEOMETRY type
2025-05-31 09:42:01,580 - parcel_filter.core.filter - INFO - Loaded 4538 parcels after initial filtering
2025-05-31 09:42:01,580 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 09:42:01,870 - parcel_filter.core.filter - INFO - After airport filtering: 4493 parcels
2025-05-31 09:42:01,871 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 09:42:01,918 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 09:42:02,104 - parcel_filter.core.filter - INFO - After transmission line filtering: 2674 parcels
2025-05-31 09:42:02,104 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Western
2025-05-31 09:42:02,112 - parcel_filter.core.filter - WARNING - No parcels found with provider 'Western'. This might indicate an issue with the data or query.
2025-05-31 09:42:02,112 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_western
2025-05-31 09:42:02,131 - parcel_filter.core.filter - INFO - After provider filtering: 0 parcels
2025-05-31 09:42:02,131 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 09:42:02,159 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 09:42:02,160 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 09:42:02,210 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 09:42:03,389 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 09:42:03,389 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 09:42:03,389 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_094203
2025-05-31 09:42:03,417 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_094203/weights_20250531_094203.json
2025-05-31 09:42:03,979 - pyogrio._io - INFO - Created 2,674 records
2025-05-31 09:42:03,996 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_094203/20250531_094203_ranked_parcels.gpkg
2025-05-31 09:42:08,248 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 09:42:08,249 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 09:42:08,249 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 09:42:08,249 - parcel_filter.core.ranking - INFO -   Mean score: 5.07
2025-05-31 09:42:08,257 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 09:42:08,259 - parcel_filter.core.ranking - INFO -   Parcel 40205015C: Score 10.00
2025-05-31 09:42:08,259 - parcel_filter.core.ranking - INFO -   Parcel 40315050B: Score 9.73
2025-05-31 09:42:08,259 - parcel_filter.core.ranking - INFO -   Parcel 40221011Z: Score 9.59
2025-05-31 09:42:08,259 - parcel_filter.core.ranking - INFO -   Parcel 40316012L: Score 9.35
2025-05-31 09:42:08,259 - parcel_filter.core.ranking - INFO -   Parcel 40345034S: Score 9.23
2025-05-31 09:42:08,259 - __main__ - INFO - Results saved in run_20250531_094203 directory
2025-05-31 09:42:14,779 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:42:14,963 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:42:16,807 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:42:16,837 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:42:16,837 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:42:16,864 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Referenced column "pin" not found in FROM clause!
Candidate bindings: "population_density", "population_growth_past_5_years", "population_growth_next_5_years", "reception_number", "dpv_notes"

LINE 14: ...rating, highest_parcel_elevation, lowest_parcel_elevation, pin, mail_province, mail_post_code, accountno, bldgid, bedr...
                                                                       ^
2025-05-31 09:42:16,870 - __main__ - ERROR - Error processing parcels: Binder Error: Referenced column "pin" not found in FROM clause!
Candidate bindings: "population_density", "population_growth_past_5_years", "population_growth_next_5_years", "reception_number", "dpv_notes"

LINE 14: ...rating, highest_parcel_elevation, lowest_parcel_elevation, pin, mail_province, mail_post_code, accountno, bldgid, bedr...
                                                                       ^
2025-05-31 09:43:56,374 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:43:56,552 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:43:58,162 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:43:58,191 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:43:58,191 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:43:58,219 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:43:58,225 - __main__ - ERROR - Error processing parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:44:58,757 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:44:58,928 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:45:01,793 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:45:01,825 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:45:01,826 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:45:01,852 - parcel_filter.core.filter - ERROR - Error loading parcels: Parser Error: syntax error at or near "WITH"
2025-05-31 09:45:01,857 - __main__ - ERROR - Error processing parcels: Parser Error: syntax error at or near "WITH"
2025-05-31 09:45:44,803 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:45:45,109 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:45:46,894 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:45:46,925 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:45:46,925 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:45:46,958 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Values list "p" does not have a column named "accounttype"

LINE 5:                             p.account_number, p.accountno, p.accounttype, p.accttype, p.acttotalval_adjusted, p.actualval...
                                                                   ^
2025-05-31 09:45:46,964 - __main__ - ERROR - Error processing parcels: Binder Error: Values list "p" does not have a column named "accounttype"

LINE 5:                             p.account_number, p.accountno, p.accounttype, p.accttype, p.acttotalval_adjusted, p.actualval...
                                                                   ^
2025-05-31 09:46:46,208 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:46:46,526 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:46:48,889 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:46:48,922 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:46:48,922 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:46:48,956 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:46:48,962 - __main__ - ERROR - Error processing parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:48:08,865 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:48:09,124 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:48:11,227 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:48:11,260 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:48:11,260 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:48:11,454 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 09:48:11,477 - __main__ - ERROR - Error processing parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 09:49:11,842 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:49:12,044 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:49:14,493 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:49:14,524 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:49:14,525 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:49:14,747 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Table "p" does not have a column named "accounttype"

Candidate bindings: : "accttype", "county"

LINE 5: ...number, COALESCE(p.accountno, NULL) as accountno, COALESCE(p.accounttype, NULL) as accounttype, COALESCE(p.accttype...
                                                                      ^
2025-05-31 09:49:14,769 - __main__ - ERROR - Error processing parcels: Binder Error: Table "p" does not have a column named "accounttype"

Candidate bindings: : "accttype", "county"

LINE 5: ...number, COALESCE(p.accountno, NULL) as accountno, COALESCE(p.accounttype, NULL) as accounttype, COALESCE(p.accttype...
                                                                      ^
2025-05-31 09:51:44,018 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:51:44,301 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:51:46,396 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:51:46,428 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:51:46,428 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:51:46,444 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 09:51:46,450 - __main__ - ERROR - Error processing parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 09:55:28,772 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:55:29,106 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:55:31,358 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:55:31,392 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:55:31,393 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:55:31,428 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:55:31,433 - __main__ - ERROR - Error processing parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:57:34,135 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:57:34,372 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:57:36,188 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:57:36,220 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:57:36,221 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:57:36,252 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:57:36,258 - __main__ - ERROR - Error processing parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 09:58:32,811 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:58:33,046 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:58:34,566 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:58:34,599 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:58:34,599 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:58:34,612 - parcel_filter.core.filter - ERROR - Error loading parcels: Parser Error: syntax error at or near "CREATE"
2025-05-31 09:58:34,618 - __main__ - ERROR - Error processing parcels: Parser Error: syntax error at or near "CREATE"
2025-05-31 09:59:37,408 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 09:59:37,648 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 09:59:39,613 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 09:59:39,645 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 09:59:39,645 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 09:59:39,655 - parcel_filter.core.filter - ERROR - Error loading parcels: Parser Error: syntax error at end of input
2025-05-31 09:59:39,662 - __main__ - ERROR - Error processing parcels: Parser Error: syntax error at end of input
2025-05-31 10:00:18,859 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:00:19,063 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:00:21,251 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:00:21,285 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:00:21,285 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:00:21,491 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: No function matches the given name and argument types 'ST_Equals(WKB_BLOB, WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Equals(GEOMETRY, GEOMETRY) -> BOOLEAN


LINE 8:                         ON ST_Equals(t.geom, p.geom)
                                   ^
2025-05-31 10:00:21,517 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_Equals(WKB_BLOB, WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Equals(GEOMETRY, GEOMETRY) -> BOOLEAN


LINE 8:                         ON ST_Equals(t.geom, p.geom)
                                   ^
2025-05-31 10:01:01,791 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:01:01,965 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:01:03,805 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:01:03,838 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:01:03,838 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:01:04,513 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: table parcels_filtered_initial has 205 columns but 198 values were supplied
2025-05-31 10:01:04,540 - __main__ - ERROR - Error processing parcels: Binder Error: table parcels_filtered_initial has 205 columns but 198 values were supplied
2025-05-31 10:02:03,335 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:02:03,525 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:02:05,785 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:02:05,818 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:02:05,818 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:02:05,847 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 10:02:05,853 - __main__ - ERROR - Error processing parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 10:03:35,770 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:03:35,944 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:03:37,310 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:03:37,343 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:03:37,343 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:03:37,374 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 10:03:37,379 - __main__ - ERROR - Error processing parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 10:04:20,908 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:04:21,084 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:04:22,821 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:04:22,852 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:04:22,852 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:04:22,865 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 10:04:22,870 - __main__ - ERROR - Error processing parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 10:05:04,255 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:05:04,429 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:05:06,149 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:05:06,181 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:05:06,181 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:05:06,210 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 10:05:06,216 - __main__ - ERROR - Error processing parcels: Binder Error: Column "accounttype" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
2025-05-31 10:36:19,384 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:36:19,696 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:36:21,718 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:36:21,750 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:36:21,751 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:36:21,958 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 10:36:21,986 - __main__ - ERROR - Error processing parcels: Binder Error: Set operations can only apply to expressions with the same number of result columns
2025-05-31 10:59:02,829 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 10:59:03,137 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 10:59:05,186 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 10:59:05,219 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 10:59:05,220 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 10:59:05,228 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 10:59:05,989 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 4:                 ST_AsText(geom) AS geom_wkt
                        ^
2025-05-31 10:59:06,020 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 4:                 ST_AsText(geom) AS geom_wkt
                        ^
2025-05-31 11:01:44,073 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:01:44,265 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:01:45,890 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:01:45,924 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:01:45,924 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:01:45,932 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:01:47,747 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:01:48,314 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:01:48,326 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:01:48,328 - parcel_filter.core.filter - ERROR - Error filtering airports: Catalog Error: Table with name parcels_filtered_initial does not exist!
Did you mean "parcels_with_drive_times"?

LINE 6:                 FROM parcels_filtered_initial p
                             ^
2025-05-31 11:01:48,367 - __main__ - ERROR - Error processing parcels: Catalog Error: Table with name parcels_filtered_initial does not exist!
Did you mean "parcels_with_drive_times"?

LINE 6:                 FROM parcels_filtered_initial p
                             ^
2025-05-31 11:02:35,474 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:02:35,659 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:02:37,184 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:02:37,217 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:02:37,217 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:02:37,225 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:02:37,701 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:02:39,384 - parcel_filter.core.filter - ERROR - Error loading parcels: Catalog Error: Table with name filtered_parcels does not exist!
Did you mean "rextag.oilseedplants"?

LINE 3:                         SELECT * FROM self.filtered_parcels
                                              ^
2025-05-31 11:02:39,409 - __main__ - ERROR - Error processing parcels: Catalog Error: Table with name filtered_parcels does not exist!
Did you mean "rextag.oilseedplants"?

LINE 3:                         SELECT * FROM self.filtered_parcels
                                              ^
2025-05-31 11:03:15,275 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:03:15,451 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:03:16,579 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:03:16,611 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:03:16,612 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:03:16,620 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:03:17,066 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:03:20,384 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:03:20,408 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:03:20,409 - parcel_filter.core.filter - ERROR - Error filtering airports: Binder Error: No function matches the given name and argument types 'ST_Intersects(VARCHAR, GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Intersects(BOX_2D, BOX_2D) -> BOOLEAN
	ST_Intersects(GEOMETRY, GEOMETRY) -> BOOLEAN


LINE 8:                     ON ST_Intersects(p.geom, a.geom)
                               ^
2025-05-31 11:03:20,439 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_Intersects(VARCHAR, GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_Intersects(BOX_2D, BOX_2D) -> BOOLEAN
	ST_Intersects(GEOMETRY, GEOMETRY) -> BOOLEAN


LINE 8:                     ON ST_Intersects(p.geom, a.geom)
                               ^
2025-05-31 11:03:55,001 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:03:55,177 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:03:57,446 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:03:57,478 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:03:57,478 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:03:57,486 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:03:59,072 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:04:00,299 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:04:00,327 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:04:00,667 - parcel_filter.core.filter - ERROR - Error filtering airports: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 4:                 ST_AsText(ST_GeomFromWKB(geom)) AS geom_wkt
                                  ^
2025-05-31 11:04:00,708 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 4:                 ST_AsText(ST_GeomFromWKB(geom)) AS geom_wkt
                                  ^
2025-05-31 11:04:27,763 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:04:27,935 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:04:29,528 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:04:29,560 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:04:29,560 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:04:29,568 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:04:31,171 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:04:32,493 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:04:32,518 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:04:34,405 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 11:04:34,406 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 11:04:34,544 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 11:04:36,015 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 11:04:36,015 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 11:04:36,061 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 11:04:36,297 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 11:04:36,297 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 11:04:36,326 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 11:04:36,326 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 11:04:36,436 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 11:04:39,259 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 11:04:39,259 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 11:04:39,260 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_110439
2025-05-31 11:04:39,312 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_110439/weights_20250531_110439.json
2025-05-31 11:04:40,842 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 11:04:40,878 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_110439/20250531_110439_ranked_parcels.gpkg
2025-05-31 11:04:46,647 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 11:04:46,647 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 11:04:46,648 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 11:04:46,648 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 11:04:46,671 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 11:04:46,672 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 11:04:46,672 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 11:04:46,672 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 11:04:46,672 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 11:04:46,672 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 11:04:46,672 - __main__ - INFO - Results saved in run_20250531_110439 directory
2025-05-31 11:04:46,672 - __main__ - INFO - Generating interactive map...
2025-05-31 11:04:46,677 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 11:04:46,682 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 11:04:46,687 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 11:04:46,688 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 11:04:46,762 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 11:04:46,766 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 11:04:46,770 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 11:04:46,772 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 11:04:46,773 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 11:04:46,836 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-31 11:04:46,915 - parcel_filter.core.map_viewer - ERROR - Error creating parcel map: Location values cannot contain NaNs.
2025-05-31 11:04:46,984 - __main__ - ERROR - Error processing parcels: Location values cannot contain NaNs.
2025-05-31 11:05:23,191 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:05:23,375 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:05:25,252 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:05:25,286 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:05:25,286 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:05:25,294 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:05:26,901 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:05:28,130 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:05:28,159 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:05:30,030 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 11:05:30,032 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 11:05:30,173 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 11:05:31,672 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 11:05:31,672 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 11:05:31,719 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 11:05:31,956 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 11:05:31,956 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 11:05:31,984 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 11:05:31,984 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 11:05:32,091 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 11:05:34,273 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 11:05:34,273 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 11:05:34,274 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_110534
2025-05-31 11:05:34,324 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_110534/weights_20250531_110534.json
2025-05-31 11:05:35,845 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 11:05:35,883 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_110534/20250531_110534_ranked_parcels.gpkg
2025-05-31 11:05:49,394 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 11:05:49,395 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 11:05:49,395 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 11:05:49,395 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 11:05:49,417 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 11:05:49,418 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 11:05:49,418 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 11:05:49,418 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 11:05:49,418 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 11:05:49,418 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 11:05:49,418 - __main__ - INFO - Results saved in run_20250531_110534 directory
2025-05-31 11:05:49,418 - __main__ - INFO - Generating interactive map...
2025-05-31 11:05:49,423 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 11:05:49,428 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 11:05:49,432 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 11:05:49,433 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 11:05:49,509 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 11:05:49,512 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 11:05:49,517 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 11:05:49,518 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 11:05:49,519 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 11:05:49,582 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-31 11:05:49,633 - parcel_filter.core.map_viewer - ERROR - Error creating parcel map: Location values cannot contain NaNs.
2025-05-31 11:05:49,703 - __main__ - ERROR - Error processing parcels: Location values cannot contain NaNs.
2025-05-31 11:06:12,589 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:06:12,774 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:06:14,934 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:06:14,969 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:06:14,969 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:06:14,978 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:06:15,441 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:06:17,780 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:06:17,806 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:06:19,830 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 11:06:19,831 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 11:06:20,015 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 11:06:22,423 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 11:06:22,424 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 11:06:22,521 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 11:06:22,944 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 11:06:22,945 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 11:06:23,031 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 11:06:23,032 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 11:06:23,325 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 11:06:26,996 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 11:06:26,996 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 11:06:26,997 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_110626
2025-05-31 11:06:27,051 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_110626/weights_20250531_110627.json
2025-05-31 11:06:28,789 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 11:06:28,826 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_110626/20250531_110626_ranked_parcels.gpkg
2025-05-31 11:20:13,379 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:20:13,593 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:20:15,402 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:20:15,436 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:20:15,436 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:20:15,444 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:20:15,860 - parcel_filter.core.filter - ERROR - Error loading parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 4:                 ST_AsText(geom) AS geom_wkt
                        ^
2025-05-31 11:20:15,876 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_AsText(WKB_BLOB)'. You might need to add explicit type casts.
	Candidate functions:
	ST_AsText(GEOMETRY) -> VARCHAR
	ST_AsText(POINT_2D) -> VARCHAR
	ST_AsText(LINESTRING_2D) -> VARCHAR
	ST_AsText(POLYGON_2D) -> VARCHAR
	ST_AsText(BOX_2D) -> VARCHAR


LINE 4:                 ST_AsText(geom) AS geom_wkt
                        ^
2025-05-31 11:20:35,979 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:20:36,161 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:20:37,611 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:20:37,645 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:20:37,645 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:20:37,654 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:20:38,166 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:20:40,573 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:20:40,598 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:20:40,948 - parcel_filter.core.filter - ERROR - Error filtering airports: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 4:                 ST_AsText(ST_GeomFromWKB(geom)) AS geom_wkt
                                  ^
2025-05-31 11:20:40,997 - __main__ - ERROR - Error processing parcels: Binder Error: No function matches the given name and argument types 'ST_GeomFromWKB(GEOMETRY)'. You might need to add explicit type casts.
	Candidate functions:
	ST_GeomFromWKB(WKB_BLOB) -> GEOMETRY
	ST_GeomFromWKB(BLOB) -> GEOMETRY


LINE 4:                 ST_AsText(ST_GeomFromWKB(geom)) AS geom_wkt
                                  ^
2025-05-31 11:24:40,123 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:24:40,418 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:24:41,957 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:24:41,991 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:24:41,992 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:24:42,000 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:24:43,879 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:24:45,218 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:24:45,243 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:24:47,158 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 11:24:47,158 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 11:24:47,298 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 11:24:48,790 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 11:24:48,791 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 11:24:48,837 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 11:24:49,075 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 11:24:49,075 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 11:24:49,106 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 11:24:49,106 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 11:24:49,220 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 11:24:51,714 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 11:24:51,714 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 11:24:51,715 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_112451
2025-05-31 11:24:51,767 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_112451/weights_20250531_112451.json
2025-05-31 11:24:53,305 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 11:24:53,341 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_112451/20250531_112451_ranked_parcels.gpkg
2025-05-31 11:24:57,856 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 11:24:57,857 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 11:24:57,857 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 11:24:57,857 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 11:24:57,878 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 11:24:57,879 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 11:24:57,879 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 11:24:57,879 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 11:24:57,880 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 11:24:57,880 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 11:24:57,880 - __main__ - INFO - Results saved in run_20250531_112451 directory
2025-05-31 11:24:57,880 - __main__ - INFO - Generating interactive map...
2025-05-31 11:24:57,885 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 11:24:57,890 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 11:24:57,895 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 11:24:57,896 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 11:24:57,974 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 11:24:57,977 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 11:24:57,982 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 11:24:57,983 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 11:24:57,984 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 11:24:59,283 - parcel_filter.core.map_viewer - WARNING - Could not load substations: name 'self' is not defined
2025-05-31 11:25:07,538 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250531_112451/co_all_counties_parcel_map.html
2025-05-31 11:26:38,356 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:26:38,704 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:26:39,395 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:26:39,415 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:26:39,415 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:26:39,422 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:26:41,245 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:26:42,584 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:26:42,608 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:26:44,454 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 11:26:44,455 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 11:26:44,596 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 11:26:46,091 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 11:26:46,091 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 11:26:46,137 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 11:26:46,379 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 11:26:46,379 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 11:26:46,407 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 11:26:46,407 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 11:26:46,519 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 11:26:48,705 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 11:26:48,705 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 11:26:48,706 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_112648
2025-05-31 11:26:48,757 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_112648/weights_20250531_112648.json
2025-05-31 11:26:50,297 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 11:26:50,337 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_112648/20250531_112648_ranked_parcels.gpkg
2025-05-31 11:30:11,312 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 11:30:11,313 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 11:30:11,314 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 11:30:11,314 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 11:30:11,346 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 11:30:11,347 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 11:30:11,347 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 11:30:11,347 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 11:30:11,347 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 11:30:11,347 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 11:30:11,348 - __main__ - INFO - Results saved in run_20250531_112648 directory
2025-05-31 11:30:11,348 - __main__ - INFO - Generating interactive map...
2025-05-31 11:30:11,354 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 11:30:11,359 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 11:30:11,364 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 11:30:11,365 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 11:30:11,442 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 11:30:11,445 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 11:30:11,450 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 11:30:11,451 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 11:30:11,452 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 11:30:41,064 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250531_112648/co_all_counties_parcel_map.html
2025-05-31 11:42:41,831 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 11:42:42,131 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 11:42:43,921 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 11:42:43,944 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 11:42:43,944 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 11:42:43,951 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 11:42:45,918 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 11:42:47,268 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 11:42:47,292 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 11:42:49,183 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 11:42:49,183 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 11:42:49,323 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 11:42:50,951 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 11:42:50,951 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 11:42:51,004 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 11:42:51,250 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 11:42:51,250 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 11:42:51,281 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 11:42:51,281 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 11:42:51,395 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 11:42:54,042 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 11:42:54,042 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 11:42:54,043 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_114254
2025-05-31 11:42:54,091 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_114254/weights_20250531_114254.json
2025-05-31 11:42:55,620 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 11:42:55,653 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_114254/20250531_114254_ranked_parcels.gpkg
2025-05-31 11:44:56,026 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 11:44:56,028 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 11:44:56,028 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 11:44:56,028 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 11:44:56,062 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 11:44:56,063 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 11:44:56,064 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 11:44:56,064 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 11:44:56,064 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 11:44:56,064 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 11:44:56,064 - __main__ - INFO - Results saved in run_20250531_114254 directory
2025-05-31 11:44:56,064 - __main__ - INFO - Generating interactive map...
2025-05-31 11:44:56,111 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-31 11:44:56,112 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [inf inf inf inf]
2025-05-31 11:44:56,112 - parcel_filter.core.map_viewer - INFO - Map center: lat=inf, lon=inf
2025-05-31 11:44:57,495 - parcel_filter.core.map_viewer - WARNING - Could not load substations: Binder Error: Referenced column "inf" not found in FROM clause!
Candidate bindings: "geom"

LINE 4:                     WHERE ST_Within(geom, ST_MakeEnvelope(inf, inf, inf, inf, 4326))
                                                                  ^
2025-05-31 11:44:57,504 - parcel_filter.core.map_viewer - ERROR - Error creating parcel map: Object of type Timestamp is not JSON serializable
2025-05-31 11:44:57,577 - __main__ - ERROR - Error processing parcels: Object of type Timestamp is not JSON serializable
2025-05-31 16:02:27,068 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 16:02:27,395 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 16:02:34,052 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 16:02:34,087 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 16:02:34,087 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 16:02:34,096 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 16:02:34,713 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 16:02:37,287 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 16:02:37,314 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 16:02:39,196 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 16:02:39,196 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 16:02:39,335 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 16:02:40,843 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 16:02:40,843 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 16:02:40,889 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 16:02:41,119 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 16:02:41,119 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 16:02:41,148 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 16:02:41,148 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 16:02:41,257 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 16:02:44,451 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 16:02:44,452 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 16:02:44,452 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_160244
2025-05-31 16:02:44,502 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_160244/weights_20250531_160244.json
2025-05-31 16:02:46,003 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 16:02:46,035 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_160244/20250531_160244_ranked_parcels.gpkg
2025-05-31 16:03:54,369 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 16:03:54,372 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 16:03:54,372 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 16:03:54,372 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 16:03:54,437 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 16:03:54,438 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 16:03:54,438 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 16:03:54,438 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 16:03:54,438 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 16:03:54,439 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 16:03:54,439 - __main__ - INFO - Results saved in run_20250531_160244 directory
2025-05-31 16:03:54,439 - __main__ - INFO - Generating interactive map...
2025-05-31 16:03:54,445 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 16:03:54,449 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 16:03:54,454 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 16:03:54,455 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 16:03:54,528 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 16:03:54,532 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 16:03:54,536 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 16:03:54,537 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 16:03:54,538 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 16:03:54,618 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-31 16:03:54,619 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [inf inf inf inf]
2025-05-31 16:03:54,619 - parcel_filter.core.map_viewer - WARNING - Invalid bounds, using default center
2025-05-31 16:03:54,619 - parcel_filter.core.map_viewer - ERROR - Error creating parcel map: name 'default_centers' is not defined
2025-05-31 16:03:54,736 - __main__ - ERROR - Error processing parcels: name 'default_centers' is not defined
2025-05-31 16:05:12,566 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 16:05:12,843 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 16:05:18,048 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 16:05:18,082 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 16:05:18,082 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 16:05:18,090 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 16:05:19,893 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 16:05:21,244 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 16:05:21,269 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 16:05:23,149 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 16:05:23,149 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 16:05:23,289 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 16:05:24,789 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 16:05:24,789 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 16:05:24,835 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 16:05:25,071 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 16:05:25,072 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 16:05:25,100 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 16:05:25,100 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 16:05:25,363 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 16:05:27,605 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 16:05:27,606 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 16:05:27,610 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_160527
2025-05-31 16:05:27,667 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_160527/weights_20250531_160527.json
2025-05-31 16:05:29,206 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 16:05:29,242 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_160527/20250531_160527_ranked_parcels.gpkg
2025-05-31 16:06:17,567 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 16:06:17,568 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 16:06:17,568 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 16:06:17,568 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 16:06:17,598 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 16:06:17,599 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 16:06:17,599 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 16:06:17,599 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 16:06:17,599 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 16:06:17,600 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 16:06:17,600 - __main__ - INFO - Results saved in run_20250531_160527 directory
2025-05-31 16:06:17,600 - __main__ - INFO - Generating interactive map...
2025-05-31 16:06:17,605 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 16:06:17,610 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 16:06:17,615 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 16:06:17,616 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 16:06:17,689 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 16:06:17,692 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 16:06:17,697 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 16:06:17,698 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 16:06:17,699 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 16:06:17,700 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 9157
2025-05-31 16:06:17,739 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
    ogc_fid  geoid    parcelnumb  ... building_cover_prec_invert  parcel_rank parcel_rank_normalized
0  330944.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
1  266432.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
2  382261.0  08123  053510000010  ...                   8.972498     5.459080               7.461731
3  389485.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
4  346262.0  08123  047318000012  ...                   8.989733     5.166378               6.734140

[5 rows x 243 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'mhspace', 'primaryowner', 'businessname', 'econareadescr', 'leadescr', 'taxarea', 'totalmilllevy', 'actualval', 'assessedval', 'accounttype', 'sub_block_lot', 'pri_owner', 'parcelnbr', 'deed_code', 'reception_number', 'padarea', 'subno', 'recptno', 'grantor', 'grantee', 'deedtype', 'docfee', 'docdt', 'excludereason', 'adjsalep', 'impvac', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-05-31 16:06:17,809 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-31 16:06:17,810 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [inf inf inf inf]
2025-05-31 16:06:17,810 - parcel_filter.core.map_viewer - WARNING - Invalid bounds, using default center
2025-05-31 16:06:27,298 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250531_160527/co_all_counties_parcel_map.html
2025-05-31 16:08:59,213 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 16:08:59,492 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-05-31 16:09:14,452 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 16:09:14,486 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-05-31 16:09:14,526 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-05-31 16:09:15,607 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 16:09:15,607 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 16:09:15,607 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_160915
2025-05-31 16:09:15,626 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_160915/weights_20250531_160915.json
2025-05-31 16:09:15,909 - pyogrio._io - INFO - Created 1,144 records
2025-05-31 16:09:15,919 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_160915/20250531_160915_ranked_parcels.gpkg
2025-05-31 16:09:21,094 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 16:09:21,095 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 16:09:21,095 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 16:09:21,095 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-05-31 16:09:21,101 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 16:09:21,102 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-05-31 16:09:21,102 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-05-31 16:09:21,102 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-05-31 16:09:21,102 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-05-31 16:09:21,102 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-05-31 16:09:21,102 - __main__ - INFO - Results saved in run_20250531_160915 directory
2025-05-31 16:09:21,102 - __main__ - INFO - Generating interactive map...
2025-05-31 16:09:21,104 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 16:09:21,106 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 16:09:21,106 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 16:09:21,107 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 16:09:21,117 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 16:09:21,118 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 16:09:21,119 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 16:09:21,120 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 16:09:21,121 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 16:09:21,121 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 1144
2025-05-31 16:09:21,161 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
   ogc_fid  geoid     parcelnumb  ... building_cover_prec_invert parcel_rank parcel_rank_normalized
0   7469.0  08001  0181500000203  ...                   9.000000    4.182908               5.312630
1  10524.0  08001  0181329100001  ...                   8.953656    4.118859               5.130244
2   6132.0  08001  0156300000078  ...                   9.000000    4.210593               5.391463
3   5570.0  08001  0155500000108  ...                   9.000000    4.143995               5.201822
4   5660.0  08001  0155701300001  ...                   8.987358    4.136396               5.180182

[5 rows x 223 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'recptno', 'deedtype', 'grantee', 'docfee', 'docdt', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'lbcs_activity_desc_1', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-05-31 16:09:21,183 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-31 16:09:21,183 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [-105.051629    39.7381905 -103.705663    40.001342 ]
2025-05-31 16:09:21,183 - parcel_filter.core.map_viewer - INFO - Map center: lat=39.86976625000002, lon=-104.378646
2025-05-31 16:09:21,382 - parcel_filter.core.map_viewer - WARNING - Could not load substations: Binder Error: No function matches the given name and argument types 'ST_MakeEnvelope(DECIMAL(17,14), DECIMAL(16,14), DECIMAL(9,6), DECIMAL(17,15), INTEGER_LITERAL)'. You might need to add explicit type casts.
	Candidate functions:
	ST_MakeEnvelope(DOUBLE, DOUBLE, DOUBLE, DOUBLE) -> GEOMETRY


LINE 4:                     WHERE ST_Within(geom, ST_MakeEnvelope(-105.05162899999999, 39.73819050000002,...
                                                  ^
2025-05-31 16:09:22,416 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250531_160915/co_adams_parcel_map.html
2025-05-31 21:26:24,237 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 21:26:24,556 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 21:26:49,906 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 21:26:49,929 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 21:26:49,929 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 21:26:49,936 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 21:26:51,951 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 21:26:52,538 - parcel_filter.core.filter - INFO - Merged state GeoDataFrame has 21476 features. Sample:
   ogc_fid  geoid    parcelnumb parcelnumb_no_formatting  ... vacimp milllevy acttotalval_adjusted asdtotalval_adjusted
0   254053  08123  070536400017             070536400017  ...    NaN      NaN                  NaN                  NaN
1     5391  08123  047317000009             047317000009  ...    NaN      NaN                  NaN                  NaN
2     5361  08123  047332000008             047332000008  ...    NaN      NaN                  NaN                  NaN
3     5364  08123  047310000003             047310000003  ...    NaN      NaN                  NaN                  NaN
4     5372  08123  047322000004             047322000004  ...    NaN      NaN                  NaN                  NaN

[5 rows x 227 columns]
2025-05-31 21:26:52,636 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 21:26:52,648 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 21:26:52,653 - parcel_filter.core.filter - ERROR - Error filtering airports: Catalog Error: Table with name parcels_filtered_initial does not exist!
Did you mean "parcels_with_drive_times"?

LINE 6:                 FROM parcels_filtered_initial p
                             ^
2025-05-31 21:26:52,684 - __main__ - ERROR - Error processing parcels: Catalog Error: Table with name parcels_filtered_initial does not exist!
Did you mean "parcels_with_drive_times"?

LINE 6:                 FROM parcels_filtered_initial p
                             ^
2025-05-31 21:29:01,747 - root - INFO - Virtual environment already exists. Skipping setup.
2025-05-31 21:29:01,958 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-05-31 21:29:04,419 - __main__ - INFO - Selected power provider: Xcel
2025-05-31 21:29:04,451 - __main__ - INFO - No checkpoints found, running full pipeline
2025-05-31 21:29:04,451 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-05-31 21:29:04,460 - parcel_filter.core.filter - INFO - Processing county: weld
2025-05-31 21:29:06,251 - parcel_filter.core.filter - INFO - Processing county: adams
2025-05-31 21:29:06,826 - parcel_filter.core.filter - INFO - Merged state GeoDataFrame has 21476 features. Sample:
   ogc_fid  geoid    parcelnumb parcelnumb_no_formatting  ... vacimp milllevy acttotalval_adjusted asdtotalval_adjusted
0   254053  08123  070536400017             070536400017  ...    NaN      NaN                  NaN                  NaN
1     5391  08123  047317000009             047317000009  ...    NaN      NaN                  NaN                  NaN
2     5361  08123  047332000008             047332000008  ...    NaN      NaN                  NaN                  NaN
3     5364  08123  047310000003             047310000003  ...    NaN      NaN                  NaN                  NaN
4     5372  08123  047322000004             047322000004  ...    NaN      NaN                  NaN                  NaN

[5 rows x 227 columns]
2025-05-31 21:29:07,666 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-05-31 21:29:07,690 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-05-31 21:29:09,599 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-05-31 21:29:09,599 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-05-31 21:29:09,739 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-05-31 21:29:11,363 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-05-31 21:29:11,363 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-05-31 21:29:11,409 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-05-31 21:29:11,644 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-05-31 21:29:11,644 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-05-31 21:29:11,673 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-05-31 21:29:11,674 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-05-31 21:29:11,787 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-05-31 21:29:14,638 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-05-31 21:29:14,638 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-05-31 21:29:14,639 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250531_212914
2025-05-31 21:29:14,693 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250531_212914/weights_20250531_212914.json
2025-05-31 21:29:16,246 - pyogrio._io - INFO - Created 9,157 records
2025-05-31 21:29:16,284 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250531_212914/20250531_212914_ranked_parcels.gpkg
2025-05-31 21:29:19,066 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-05-31 21:29:19,066 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-05-31 21:29:19,067 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-05-31 21:29:19,067 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-05-31 21:29:19,093 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-05-31 21:29:19,094 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-05-31 21:29:19,094 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-05-31 21:29:19,094 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-05-31 21:29:19,094 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-05-31 21:29:19,094 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-05-31 21:29:19,094 - __main__ - INFO - Results saved in run_20250531_212914 directory
2025-05-31 21:29:19,094 - __main__ - INFO - Generating interactive map...
2025-05-31 21:29:19,099 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-05-31 21:29:19,104 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-05-31 21:29:19,109 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-05-31 21:29:19,109 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-05-31 21:29:19,202 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-05-31 21:29:19,206 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-05-31 21:29:19,211 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-05-31 21:29:19,213 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-05-31 21:29:19,214 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-05-31 21:29:19,214 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 9157
2025-05-31 21:29:19,257 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
    ogc_fid  geoid    parcelnumb  ... building_cover_prec_invert  parcel_rank parcel_rank_normalized
0  330944.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
1  266432.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
2  382261.0  08123  053510000010  ...                   8.972498     5.459080               7.461731
3  389485.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
4  346262.0  08123  047318000012  ...                   8.989733     5.166378               6.734140

[5 rows x 243 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'mhspace', 'primaryowner', 'businessname', 'econareadescr', 'leadescr', 'taxarea', 'totalmilllevy', 'actualval', 'assessedval', 'accounttype', 'sub_block_lot', 'pri_owner', 'parcelnbr', 'deed_code', 'reception_number', 'padarea', 'subno', 'recptno', 'grantor', 'grantee', 'deedtype', 'docfee', 'docdt', 'excludereason', 'adjsalep', 'impvac', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-05-31 21:29:19,330 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-05-31 21:29:19,331 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [inf inf inf inf]
2025-05-31 21:29:19,331 - parcel_filter.core.map_viewer - WARNING - Invalid bounds, using default center
2025-05-31 21:29:28,896 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250531_212914/co_all_counties_parcel_map.html
2025-06-01 10:28:19,351 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-01 10:28:19,697 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-06-01 10:28:21,389 - __main__ - INFO - Selected power provider: Xcel
2025-06-01 10:28:21,424 - __main__ - INFO - No checkpoints found, running full pipeline
2025-06-01 10:28:21,424 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-06-01 10:28:21,433 - parcel_filter.core.filter - INFO - Processing county: weld
2025-06-01 10:28:23,267 - parcel_filter.core.filter - INFO - Processing county: adams
2025-06-01 10:28:23,880 - parcel_filter.core.filter - INFO - Merged state GeoDataFrame has 21476 features. Sample:
   ogc_fid  geoid    parcelnumb parcelnumb_no_formatting  ... vacimp milllevy acttotalval_adjusted asdtotalval_adjusted
0   254053  08123  070536400017             070536400017  ...    NaN      NaN                  NaN                  NaN
1     5391  08123  047317000009             047317000009  ...    NaN      NaN                  NaN                  NaN
2     5361  08123  047332000008             047332000008  ...    NaN      NaN                  NaN                  NaN
3     5364  08123  047310000003             047310000003  ...    NaN      NaN                  NaN                  NaN
4     5372  08123  047322000004             047322000004  ...    NaN      NaN                  NaN                  NaN

[5 rows x 227 columns]
2025-06-01 10:28:26,349 - parcel_filter.core.filter - INFO - After round-trip to DuckDB, number of features: 21476
2025-06-01 10:28:26,350 - parcel_filter.core.filter - INFO - Sample after round-trip:
   ogc_fid  geoid  ... asdtotalval_adjusted                                           geometry
0   254053  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
1     5391  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
2     5361  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
3     5364  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
4     5372  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...

[5 rows x 227 columns]
2025-06-01 10:28:26,423 - parcel_filter.core.filter - INFO - Bounds after round-trip: [inf inf inf inf]
2025-06-01 10:28:26,428 - parcel_filter.core.filter - INFO - Geometry types: Polygon         19955
MultiPolygon     1521
Name: count, dtype: int64
2025-06-01 10:28:26,430 - parcel_filter.core.filter - INFO - Number of empty geometries: 0
2025-06-01 10:28:26,431 - parcel_filter.core.filter - INFO - Number of NaN geometries: 0
2025-06-01 10:28:26,431 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-06-01 10:28:26,488 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-06-01 10:28:28,405 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-06-01 10:28:28,406 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-06-01 10:28:28,545 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-06-01 10:28:30,005 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-06-01 10:28:30,005 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-06-01 10:28:30,051 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-06-01 10:28:30,288 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-06-01 10:28:30,288 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-06-01 10:28:30,316 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-06-01 10:28:30,317 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-06-01 10:28:30,430 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-06-01 10:28:32,886 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-01 10:28:32,887 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-01 10:28:32,887 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250601_102832
2025-06-01 10:28:32,938 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250601_102832/weights_20250601_102832.json
2025-06-01 10:28:34,459 - pyogrio._io - INFO - Created 9,157 records
2025-06-01 10:28:34,492 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250601_102832/20250601_102832_ranked_parcels.gpkg
2025-06-01 10:31:13,511 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-01 10:31:13,515 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-01 10:31:13,515 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-01 10:31:13,515 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-06-01 10:31:13,561 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-01 10:31:13,563 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-06-01 10:31:13,563 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-06-01 10:31:13,563 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-06-01 10:31:13,563 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-06-01 10:31:13,563 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-06-01 10:31:13,563 - __main__ - INFO - Results saved in run_20250601_102832 directory
2025-06-01 10:31:13,563 - __main__ - INFO - Generating interactive map...
2025-06-01 10:31:13,568 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-06-01 10:31:13,573 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-06-01 10:31:13,578 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-06-01 10:31:13,579 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-06-01 10:31:13,653 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-06-01 10:31:13,656 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-06-01 10:31:13,661 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-06-01 10:31:13,663 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-06-01 10:31:13,663 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-06-01 10:31:13,664 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 9157
2025-06-01 10:31:13,703 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
    ogc_fid  geoid    parcelnumb  ... building_cover_prec_invert  parcel_rank parcel_rank_normalized
0  330944.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
1  266432.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
2  382261.0  08123  053510000010  ...                   8.972498     5.459080               7.461731
3  389485.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
4  346262.0  08123  047318000012  ...                   8.989733     5.166378               6.734140

[5 rows x 243 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'mhspace', 'primaryowner', 'businessname', 'econareadescr', 'leadescr', 'taxarea', 'totalmilllevy', 'actualval', 'assessedval', 'accounttype', 'sub_block_lot', 'pri_owner', 'parcelnbr', 'deed_code', 'reception_number', 'padarea', 'subno', 'recptno', 'grantor', 'grantee', 'deedtype', 'docfee', 'docdt', 'excludereason', 'adjsalep', 'impvac', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-06-01 10:31:13,776 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-06-01 10:31:13,779 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [inf inf inf inf]
2025-06-01 10:31:13,779 - parcel_filter.core.map_viewer - WARNING - Invalid bounds, using default center
2025-06-01 10:31:23,545 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250601_102832/co_all_counties_parcel_map.html
2025-06-01 10:35:14,189 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-01 10:35:14,787 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-06-01 10:37:54,706 - __main__ - INFO - Selected power provider: Xcel
2025-06-01 10:37:54,734 - __main__ - INFO - No checkpoints found, running full pipeline
2025-06-01 10:37:54,734 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-06-01 10:37:54,744 - parcel_filter.core.filter - INFO - Processing county: weld
2025-06-01 10:37:56,745 - parcel_filter.core.filter - INFO - Processing county: adams
2025-06-01 10:37:57,340 - parcel_filter.core.filter - INFO - Merged state GeoDataFrame has 21476 features. Sample:
   ogc_fid  geoid    parcelnumb parcelnumb_no_formatting  ... vacimp milllevy acttotalval_adjusted asdtotalval_adjusted
0   254053  08123  070536400017             070536400017  ...    NaN      NaN                  NaN                  NaN
1     5391  08123  047317000009             047317000009  ...    NaN      NaN                  NaN                  NaN
2     5361  08123  047332000008             047332000008  ...    NaN      NaN                  NaN                  NaN
3     5364  08123  047310000003             047310000003  ...    NaN      NaN                  NaN                  NaN
4     5372  08123  047322000004             047322000004  ...    NaN      NaN                  NaN                  NaN

[5 rows x 227 columns]
2025-06-01 10:38:00,207 - parcel_filter.core.filter - INFO - After round-trip to DuckDB (WKT), number of features: 21476
2025-06-01 10:38:00,207 - parcel_filter.core.filter - INFO - Sample after round-trip:
   ogc_fid  geoid  ... asdtotalval_adjusted                                           geometry
0   254053  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
1     5391  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
2     5361  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
3     5364  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...
4     5372  08123  ...                 None  POLYGON ((Infinity Infinity, Infinity Infinity...

[5 rows x 227 columns]
2025-06-01 10:38:00,281 - parcel_filter.core.filter - INFO - Bounds after round-trip: [inf inf inf inf]
2025-06-01 10:38:00,286 - parcel_filter.core.filter - INFO - Geometry types: Polygon         19955
MultiPolygon     1521
Name: count, dtype: int64
2025-06-01 10:38:00,288 - parcel_filter.core.filter - INFO - Number of empty geometries: 0
2025-06-01 10:38:00,288 - parcel_filter.core.filter - INFO - Number of NaN geometries: 0
2025-06-01 10:38:00,288 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-06-01 10:38:00,346 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-06-01 10:38:02,271 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-06-01 10:38:02,271 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-06-01 10:38:02,414 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-06-01 10:38:03,944 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-06-01 10:38:03,944 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-06-01 10:38:03,995 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-06-01 10:38:04,283 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-06-01 10:38:04,283 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-06-01 10:38:04,318 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-06-01 10:38:04,319 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-06-01 10:38:04,499 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-06-01 10:38:07,050 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-01 10:38:07,050 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-01 10:38:07,050 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250601_103807
2025-06-01 10:38:07,101 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250601_103807/weights_20250601_103807.json
2025-06-01 10:38:08,675 - pyogrio._io - INFO - Created 9,157 records
2025-06-01 10:38:08,708 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250601_103807/20250601_103807_ranked_parcels.gpkg
2025-06-01 18:46:22,929 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-01 18:46:22,932 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-01 18:46:22,932 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-01 18:46:22,932 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-06-01 18:46:22,995 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-01 18:46:22,997 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-06-01 18:46:22,997 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-06-01 18:46:22,997 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-06-01 18:46:22,997 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-06-01 18:46:22,998 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-06-01 18:46:22,998 - __main__ - INFO - Results saved in run_20250601_103807 directory
2025-06-01 18:46:22,998 - __main__ - INFO - Generating interactive map...
2025-06-01 18:46:23,003 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-06-01 18:46:23,008 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-06-01 18:46:23,013 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-06-01 18:46:23,014 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-06-01 18:46:23,092 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-06-01 18:46:23,095 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-06-01 18:46:23,100 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-06-01 18:46:23,102 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-06-01 18:46:23,103 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-06-01 18:46:23,103 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 9157
2025-06-01 18:46:23,142 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
    ogc_fid  geoid    parcelnumb  ... building_cover_prec_invert  parcel_rank parcel_rank_normalized
0  330944.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
1  266432.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
2  382261.0  08123  053510000010  ...                   8.972498     5.459080               7.461731
3  389485.0  08123  053510000010  ...                   8.972498     5.609080               7.834597
4  346262.0  08123  047318000012  ...                   8.989733     5.166378               6.734140

[5 rows x 243 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'mhspace', 'primaryowner', 'businessname', 'econareadescr', 'leadescr', 'taxarea', 'totalmilllevy', 'actualval', 'assessedval', 'accounttype', 'sub_block_lot', 'pri_owner', 'parcelnbr', 'deed_code', 'reception_number', 'padarea', 'subno', 'recptno', 'grantor', 'grantee', 'deedtype', 'docfee', 'docdt', 'excludereason', 'adjsalep', 'impvac', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-06-01 18:46:23,228 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-06-01 18:46:23,229 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [inf inf inf inf]
2025-06-01 18:46:23,229 - parcel_filter.core.map_viewer - WARNING - Invalid bounds, using default center
2025-06-01 18:46:33,001 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250601_103807/co_all_counties_parcel_map.html
2025-06-01 18:51:02,948 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-01 18:51:03,236 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-06-01 18:51:04,786 - __main__ - INFO - Selected power provider: Xcel
2025-06-01 18:51:04,819 - __main__ - INFO - No checkpoints found, running full pipeline
2025-06-01 18:51:04,819 - parcel_filter.core.filter - INFO - Loading parcels with size > 50 acres and excluding unwanted activities...
2025-06-01 18:51:04,828 - parcel_filter.core.filter - INFO - Processing county: adams
2025-06-01 18:51:05,448 - parcel_filter.core.filter - INFO - Processing county: weld
2025-06-01 18:51:07,301 - parcel_filter.core.filter - INFO - Merged state GeoDataFrame has 21476 features. Sample:
   ogc_fid  geoid     parcelnumb parcelnumb_no_formatting  ... grantor excludereason adjsalep impvac
0    26690  08001  0157107000014            0157107000014  ...     NaN           NaN      NaN    NaN
1    26736  08001  0157108200002            0157108200002  ...     NaN           NaN      NaN    NaN
2   190450  08001  0181930401018            0181930401018  ...     NaN           NaN      NaN    NaN
3     5058  08001  0172300000241            0172300000241  ...     NaN           NaN      NaN    NaN
4    44142  08001  0157328002005            0157328002005  ...     NaN           NaN      NaN    NaN

[5 rows x 227 columns]
2025-06-01 18:51:09,944 - parcel_filter.core.filter - INFO - After round-trip to DuckDB (WKT), number of features: 21476
2025-06-01 18:51:09,945 - parcel_filter.core.filter - INFO - Sample after round-trip:
   ogc_fid  geoid     parcelnumb  ... adjsalep  impvac                                           geometry
0    26690  08001  0157107000014  ...      NaN    None  POLYGON ((Infinity Infinity, Infinity Infinity...
1    26736  08001  0157108200002  ...      NaN    None  POLYGON ((Infinity Infinity, Infinity Infinity...
2   190450  08001  0181930401018  ...      NaN    None  MULTIPOLYGON (((Infinity Infinity, Infinity In...
3     5058  08001  0172300000241  ...      NaN    None  POLYGON ((Infinity Infinity, Infinity Infinity...
4    44142  08001  0157328002005  ...      NaN    None  POLYGON ((Infinity Infinity, Infinity Infinity...

[5 rows x 227 columns]
2025-06-01 18:51:10,019 - parcel_filter.core.filter - INFO - Bounds after round-trip: [inf inf inf inf]
2025-06-01 18:51:10,024 - parcel_filter.core.filter - INFO - Geometry types: Polygon         19955
MultiPolygon     1521
Name: count, dtype: int64
2025-06-01 18:51:10,025 - parcel_filter.core.filter - INFO - Number of empty geometries: 0
2025-06-01 18:51:10,026 - parcel_filter.core.filter - INFO - Number of NaN geometries: 0
2025-06-01 18:51:10,026 - parcel_filter.core.filter - INFO - Loaded 21476 parcels after initial filtering
2025-06-01 18:51:10,082 - parcel_filter.core.filter - INFO - Filtering parcels that intersect with airports...
2025-06-01 18:51:11,965 - parcel_filter.core.filter - INFO - After airport filtering: 21476 parcels
2025-06-01 18:51:11,966 - parcel_filter.core.filter - INFO - Filtering parcels by distance to transmission lines...
2025-06-01 18:51:12,111 - parcel_filter.core.filter - INFO - Saving checkpoint: transmission_filtered_100m
2025-06-01 18:51:14,796 - parcel_filter.core.filter - INFO - After transmission line filtering: 9157 parcels
2025-06-01 18:51:14,797 - parcel_filter.core.filter - INFO - Filtering parcels by power provider: Xcel
2025-06-01 18:51:14,883 - parcel_filter.core.filter - INFO - Saving checkpoint: provider_filtered_xcel
2025-06-01 18:51:15,380 - parcel_filter.core.filter - INFO - After provider filtering: 2168 parcels
2025-06-01 18:51:15,381 - parcel_filter.core.filter - INFO - Loading isochrone data from database
2025-06-01 18:51:15,428 - parcel_filter.core.filter - INFO - Loaded 6 isochrone polygons
2025-06-01 18:51:15,429 - parcel_filter.core.filter - INFO - Calculating drive times...
2025-06-01 18:51:15,606 - parcel_filter.core.filter - INFO - Saving checkpoint: drive_times
2025-06-01 18:51:18,923 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-01 18:51:18,924 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-01 18:51:18,924 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250601_185118
2025-06-01 18:51:18,972 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250601_185118/weights_20250601_185118.json
2025-06-01 18:51:20,814 - pyogrio._io - INFO - Created 9,157 records
2025-06-01 18:51:20,863 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250601_185118/20250601_185118_ranked_parcels.gpkg
2025-06-01 18:51:23,118 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-01 18:51:23,119 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-01 18:51:23,119 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-01 18:51:23,119 - parcel_filter.core.ranking - INFO -   Mean score: 6.92
2025-06-01 18:51:23,151 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-01 18:51:23,153 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 10.00
2025-06-01 18:51:23,153 - parcel_filter.core.ranking - INFO -   Parcel 096513100004: Score 9.85
2025-06-01 18:51:23,153 - parcel_filter.core.ranking - INFO -   Parcel 096524100003: Score 9.85
2025-06-01 18:51:23,153 - parcel_filter.core.ranking - INFO -   Parcel 096717100004: Score 9.85
2025-06-01 18:51:23,153 - parcel_filter.core.ranking - INFO -   Parcel 055515000006: Score 9.85
2025-06-01 18:51:23,153 - __main__ - INFO - Results saved in run_20250601_185118 directory
2025-06-01 18:51:23,153 - __main__ - INFO - Generating interactive map...
2025-06-01 18:51:23,158 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-06-01 18:51:23,163 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-06-01 18:51:23,167 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-06-01 18:51:23,168 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-06-01 18:51:23,242 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-06-01 18:51:23,245 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-06-01 18:51:23,250 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-06-01 18:51:23,252 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-06-01 18:51:23,253 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-06-01 18:51:23,254 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 9157
2025-06-01 18:51:23,292 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
   ogc_fid  geoid     parcelnumb  ... building_cover_prec_invert  parcel_rank parcel_rank_normalized
0   5058.0  08001  0172300000241  ...                   9.000000     4.260000               4.481089
1  10524.0  08001  0181329100001  ...                   8.959898     4.160918               4.234794
2   2391.0  08001  0181333200001  ...                   9.000000     4.169628               4.256444
3   6579.0  08001  0156524100001  ...                   8.953381     4.389534               4.803081
4   5572.0  08001  0155500000112  ...                   9.000000     4.106207               4.098795

[5 rows x 243 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'recptno', 'deedtype', 'grantee', 'docfee', 'docdt', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'mhspace', 'primaryowner', 'businessname', 'econareadescr', 'leadescr', 'taxarea', 'totalmilllevy', 'actualval', 'assessedval', 'accounttype', 'sub_block_lot', 'pri_owner', 'parcelnbr', 'deed_code', 'reception_number', 'padarea', 'subno', 'grantor', 'excludereason', 'adjsalep', 'impvac', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-06-01 18:51:23,370 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-06-01 18:51:23,371 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [inf inf inf inf]
2025-06-01 18:51:23,371 - parcel_filter.core.map_viewer - WARNING - Invalid bounds, using default center
2025-06-01 18:51:33,185 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250601_185118/co_all_counties_parcel_map.html
2025-06-01 19:21:22,664 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-01 19:21:22,962 - parcel_filter.core.filter - INFO - Found 23 unique power providers
2025-06-09 11:04:33,325 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-09 11:04:34,147 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-09 11:04:37,861 - __main__ - INFO - Selected power provider: Xcel
2025-06-09 11:04:37,883 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-09 11:04:37,921 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-09 11:04:38,842 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-09 11:04:38,843 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-09 11:04:38,843 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250609_110438
2025-06-09 11:04:38,870 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250609_110438/weights_20250609_110438.json
2025-06-09 11:04:39,761 - pyogrio._io - INFO - Created 1,144 records
2025-06-09 11:04:39,767 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250609_110438/20250609_110438_ranked_parcels.gpkg
2025-06-09 11:04:44,893 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-09 11:04:44,893 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-09 11:04:44,893 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-09 11:04:44,894 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-06-09 11:04:44,900 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-09 11:04:44,901 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-06-09 11:04:44,901 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-06-09 11:04:44,901 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-06-09 11:04:44,901 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-06-09 11:04:44,901 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-06-09 11:04:44,901 - __main__ - INFO - Results saved in run_20250609_110438 directory
2025-06-09 11:04:44,901 - __main__ - INFO - Generating interactive map...
2025-06-09 11:04:44,903 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-06-09 11:04:44,904 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-06-09 11:04:44,905 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-06-09 11:04:44,906 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-06-09 11:04:44,918 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-06-09 11:04:44,918 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-06-09 11:04:44,920 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-06-09 11:04:44,921 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-06-09 11:04:44,921 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-06-09 11:04:44,922 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 1144
2025-06-09 11:04:44,950 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
   ogc_fid  geoid  ... parcel_rank parcel_rank_normalized
0   7469.0  08001  ...    4.182908               5.312630
1  10524.0  08001  ...    4.118859               5.130244
2   6132.0  08001  ...    4.210593               5.391463
3   5570.0  08001  ...    4.143995               5.201822
4   5660.0  08001  ...    4.136396               5.180182

[5 rows x 223 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'recptno', 'deedtype', 'grantee', 'docfee', 'docdt', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'lbcs_activity_desc_1', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-06-09 11:04:44,971 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-06-09 11:04:44,971 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [-105.051629    39.7381905 -103.705663    40.001342 ]
2025-06-09 11:04:44,971 - parcel_filter.core.map_viewer - INFO - Map center: lat=39.86976625000002, lon=-104.378646
2025-06-09 11:04:45,162 - parcel_filter.core.map_viewer - WARNING - Could not load substations: Binder Error: No function matches the given name and argument types 'ST_MakeEnvelope(DECIMAL(17,14), DECIMAL(16,14), DECIMAL(9,6), DECIMAL(17,15), INTEGER_LITERAL)'. You might need to add explicit type casts.
	Candidate functions:
	ST_MakeEnvelope(DOUBLE, DOUBLE, DOUBLE, DOUBLE) -> GEOMETRY


LINE 4:                     WHERE ST_Within(geom, ST_MakeEnvelope(-105.05162899999999, 39.73819050000002,...
                                                  ^
2025-06-09 11:04:46,184 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250609_110438/co_adams_parcel_map.html
2025-06-09 14:26:16,535 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-09 14:26:16,822 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-09 14:27:27,418 - __main__ - INFO - Selected power provider: Xcel
2025-06-09 14:27:27,438 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-09 14:27:27,474 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-09 14:27:28,353 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-09 14:27:28,353 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-09 14:27:28,354 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250609_142728
2025-06-09 14:27:28,374 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250609_142728/weights_20250609_142728.json
2025-06-09 14:27:28,637 - pyogrio._io - INFO - Created 1,144 records
2025-06-09 14:27:28,647 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250609_142728/20250609_142728_ranked_parcels.gpkg
2025-06-10 12:27:08,135 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-10 12:27:09,275 - parcel_filter.core.ranking - ERROR - Failed to load ranking data: 'Unwanted'
2025-06-10 12:27:09,275 - __main__ - ERROR - Error processing parcels: 'Unwanted'
2025-06-11 10:03:06,114 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 10:03:07,391 - parcel_filter.core.ranking - INFO - Unwanted activities columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 10:03:07,395 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 10:03:07,395 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-11 10:03:07,395 - parcel_filter.core.ranking - INFO - Loaded unwanted activities: []
2025-06-11 10:03:07,693 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-11 10:03:10,081 - __main__ - INFO - Selected power provider: Xcel
2025-06-11 10:03:10,111 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 10:03:10,149 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 10:03:11,092 - __main__ - ERROR - Error processing parcels: ParcelRanker.__init__() missing 2 required positional arguments: 'state' and 'county'
2025-06-11 10:06:48,522 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 10:06:49,375 - parcel_filter.core.ranking - INFO - Unwanted activities columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 10:06:49,378 - parcel_filter.core.ranking - ERROR - Failed to load ranking data: Can only use .str accessor with string values!
2025-06-11 10:06:49,378 - __main__ - ERROR - Error processing parcels: Can only use .str accessor with string values!
2025-06-11 10:06:53,821 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 10:06:54,507 - parcel_filter.core.ranking - INFO - Unwanted activities columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 10:06:54,508 - parcel_filter.core.ranking - ERROR - Failed to load ranking data: Can only use .str accessor with string values!
2025-06-11 10:06:54,508 - __main__ - ERROR - Error processing parcels: Can only use .str accessor with string values!
2025-06-11 10:07:18,192 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 10:07:18,482 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-11 10:07:20,338 - __main__ - INFO - Selected power provider: Xcel
2025-06-11 10:07:20,369 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 10:07:20,406 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 10:07:21,338 - __main__ - ERROR - Error processing parcels: ParcelRanker.__init__() missing 2 required positional arguments: 'state' and 'county'
2025-06-11 11:19:19,867 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 11:19:20,156 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-11 11:19:21,531 - __main__ - INFO - Selected power provider: Xcel
2025-06-11 11:19:21,562 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 11:19:21,599 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 11:19:22,524 - __main__ - ERROR - Error processing parcels: ParcelRanker.__init__() missing 2 required positional arguments: 'state' and 'county'
2025-06-11 11:21:59,109 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 11:21:59,426 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-11 11:22:00,533 - __main__ - INFO - Selected power provider: Xcel
2025-06-11 11:22:00,565 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 11:22:00,603 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 11:22:01,311 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 11:22:01,311 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-11 11:22:01,311 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250611_112201
2025-06-11 11:22:01,329 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250611_112201/weights_20250611_112201.json
2025-06-11 11:22:01,712 - pyogrio._io - INFO - Created 1,144 records
2025-06-11 11:22:01,721 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250611_112201/co_adams_20250611_112201_ranked_parcels.gpkg
2025-06-11 11:27:44,288 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-11 11:27:44,290 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-11 11:27:44,291 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-11 11:27:44,291 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-06-11 11:27:44,307 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-11 11:27:44,309 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-06-11 11:27:44,309 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-06-11 11:27:44,309 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-06-11 11:27:44,310 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-06-11 11:27:44,310 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-06-11 11:27:44,310 - __main__ - INFO - Results saved in run_20250611_112201 directory
2025-06-11 11:28:01,119 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 11:28:01,291 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-11 11:28:02,533 - __main__ - INFO - Selected power provider: Xcel
2025-06-11 11:28:02,561 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 11:28:02,597 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 11:28:03,672 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 11:28:03,673 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-11 11:28:03,673 - parcel_filter.core.ranking - INFO - Created run directory: results/run_20250611_112803
2025-06-11 11:28:03,689 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/run_20250611_112803/weights_20250611_112803.json
2025-06-11 11:28:03,909 - pyogrio._io - INFO - Created 1,144 records
2025-06-11 11:28:03,916 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/run_20250611_112803/co_adams_20250611_112803_ranked_parcels.gpkg
2025-06-11 11:28:12,330 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-11 11:28:12,331 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-11 11:28:12,331 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-11 11:28:12,331 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-06-11 11:28:12,336 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-11 11:28:12,337 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-06-11 11:28:12,337 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-06-11 11:28:12,337 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-06-11 11:28:12,337 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-06-11 11:28:12,337 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-06-11 11:28:12,337 - __main__ - INFO - Results saved in run_20250611_112803 directory
2025-06-11 11:28:12,337 - __main__ - INFO - Generating interactive map...
2025-06-11 11:28:12,340 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'saledate' to string
2025-06-11 11:28:12,341 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'fema_flood_zone_data_date' to string
2025-06-11 11:28:12,342 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_last_refresh' to string
2025-06-11 11:28:12,343 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'reviseddate' to string
2025-06-11 11:28:12,353 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'll_updated_at' to string
2025-06-11 11:28:12,354 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'usps_vacancy_date' to string
2025-06-11 11:28:12,355 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'docdt' to string
2025-06-11 11:28:12,356 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'dateadd' to string
2025-06-11 11:28:12,356 - parcel_filter.core.map_viewer - INFO - Converted Timestamp column 'datechg' to string
2025-06-11 11:28:12,357 - parcel_filter.core.map_viewer - INFO - Number of parcels passed to map: 1144
2025-06-11 11:28:12,404 - parcel_filter.core.map_viewer - INFO - Sample of parcels:
   ogc_fid  geoid     parcelnumb  ... building_cover_prec_invert parcel_rank parcel_rank_normalized
0   7469.0  08001  0181500000203  ...                   9.000000    4.182908               5.312630
1  10524.0  08001  0181329100001  ...                   8.953656    4.118859               5.130244
2   6132.0  08001  0156300000078  ...                   9.000000    4.210593               5.391463
3   5570.0  08001  0155500000108  ...                   9.000000    4.143995               5.201822
4   5660.0  08001  0155701300001  ...                   8.987358    4.136396               5.180182

[5 rows x 223 columns]
Columns: ['ogc_fid', 'geoid', 'parcelnumb', 'parcelnumb_no_formatting', 'state_parcelnumb', 'account_number', 'tax_id', 'alt_parcelnumb1', 'alt_parcelnumb2', 'alt_parcelnumb3', 'usecode', 'usedesc', 'zoning', 'zoning_description', 'zoning_type', 'zoning_subtype', 'zoning_code_link', 'zoning_id', 'struct', 'structno', 'yearbuilt', 'numstories', 'numunits', 'numrooms', 'structstyle', 'parvaltype', 'improvval', 'landval', 'parval', 'agval', 'homestead_exemption', 'saleprice', 'saledate', 'taxamt', 'taxyear', 'owntype', 'owner', 'unmodified_owner', 'ownfrst', 'ownlast', 'owner2', 'owner3', 'owner4', 'previous_owner', 'mailadd', 'mail_address2', 'careof', 'mail_addno', 'mail_addpref', 'mail_addstr', 'mail_addsttyp', 'mail_addstsuf', 'mail_unit', 'mail_city', 'mail_state2', 'mail_zip', 'mail_country', 'mail_urbanization', 'original_mailing_address', 'address', 'address2', 'saddno', 'saddpref', 'saddstr', 'saddsttyp', 'saddstsuf', 'sunit', 'scity', 'original_address', 'city', 'county', 'state2', 'szip', 'szip5', 'urbanization', 'll_address_count', 'location_name', 'address_source', 'legaldesc', 'plat', 'book', 'page', 'block', 'lot', 'neighborhood', 'neighborhood_code', 'subdivision', 'lat', 'lon', 'fema_flood_zone', 'fema_flood_zone_subtype', 'fema_flood_zone_raw', 'fema_flood_zone_data_date', 'fema_nri_risk_rating', 'qoz', 'qoz_tract', 'census_tract', 'census_block', 'census_blockgroup', 'census_zcta', 'census_elementary_school_district', 'census_secondary_school_district', 'census_unified_school_district', 'll_last_refresh', 'sourceurl', 'recrdareatx', 'recrdareano', 'deeded_acres', 'gisacre', 'sqft', 'll_gisacre', 'll_gissqft', 'll_bldg_footprint_sqft', 'll_bldg_count', 'cdl_raw', 'cdl_majority_category', 'cdl_majority_percent', 'cdl_date', 'plss_township', 'plss_section', 'plss_range', 'reviseddate', 'path', 'll_stable_id', 'll_uuid', 'll_stack_uuid', 'll_row_parcel', 'll_updated_at', 'precisely_id', 'placekey', 'dpv_status', 'dpv_codes', 'dpv_notes', 'dpv_type', 'cass_errorno', 'rdi', 'usps_vacancy', 'usps_vacancy_date', 'padus_public_access', 'lbcs_activity', 'lbcs_activity_desc', 'lbcs_function', 'lbcs_function_desc', 'lbcs_structure', 'lbcs_structure_desc', 'lbcs_site', 'lbcs_site_desc', 'lbcs_ownership', 'lbcs_ownership_desc', 'housing_affordability_index', 'population_density', 'population_growth_past_5_years', 'population_growth_next_5_years', 'housing_growth_past_5_years', 'housing_growth_next_5_years', 'household_income_growth_next_5_years', 'median_household_income', 'transmission_line_distance', 'roughness_rating', 'highest_parcel_elevation', 'lowest_parcel_elevation', 'pin', 'mail_province', 'mail_post_code', 'accountno', 'bldgid', 'bedrooms', 'baths', 'exterior', 'attgarsf', 'detgarsf', 'bsmntsf', 'finbsmntsf', 'recptno', 'deedtype', 'grantee', 'docfee', 'docdt', 'ownernamefull', 'ownercsz', 'ownercpp', 'accttype', 'dateadd', 'datechg', 'asdimpsval', 'asdtotalval', 'lotsize', 'lotmeasure', 'firename', 'schoolname', 'vacimp', 'milllevy', 'acttotalval_adjusted', 'asdtotalval_adjusted', 'et_name', 'et_sub_oper', 'et_operator', 'et_owner', 'et_kv', 'et_distance', 'est_name', 'est_sub_oper', 'est_operator', 'est_owner', 'gisacre_1', 'lbcs_activity_desc_1', 'drive_time', 'geometry', 'Zoning Ranking', 'Zoning Subtype Ranking', 'Land Activity Ranking', 'Site Descirption Ranking', 'Ownership Ranking', 'Fema NRI Flood Risk Ranking', 'Fema Flood Zone Ranking', 'Fema Flood Zone Subtype Ranking', 'gisacre_norm', 'trans_line_distance_norm', 'norm_dt', 'building_cover_prec', 'building_cover_prec_invert', 'parcel_rank', 'parcel_rank_normalized']
2025-06-11 11:28:12,426 - parcel_filter.core.map_viewer - INFO - Transformed parcels to WGS84 (EPSG:4326) for mapping
2025-06-11 11:28:12,426 - parcel_filter.core.map_viewer - INFO - Parcel bounds: [-105.051629    39.7381905 -103.705663    40.001342 ]
2025-06-11 11:28:12,427 - parcel_filter.core.map_viewer - INFO - Map center: lat=39.86976625000002, lon=-104.378646
2025-06-11 11:28:12,622 - parcel_filter.core.map_viewer - WARNING - Could not load substations: Binder Error: No function matches the given name and argument types 'ST_MakeEnvelope(DECIMAL(17,14), DECIMAL(16,14), DECIMAL(9,6), DECIMAL(17,15), INTEGER_LITERAL)'. You might need to add explicit type casts.
	Candidate functions:
	ST_MakeEnvelope(DOUBLE, DOUBLE, DOUBLE, DOUBLE) -> GEOMETRY


LINE 4:                     WHERE ST_Within(geom, ST_MakeEnvelope(-105.05162899999999, 39.73819050000002,...
                                                  ^
2025-06-11 11:28:13,650 - parcel_filter.core.map_viewer - INFO - Created interactive map at results/run_20250611_112803/co_adams_parcel_map.html
2025-06-11 11:39:07,710 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 11:39:07,718 - __main__ - ERROR - Error processing parcels: IO Error: Could not set lock on file "/Users/gavin/Desktop/Personal/Adams Geospatial/Data/Garrison/IDTool/data/LandAI.ddb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 36016) by user gavin. See also https://duckdb.org/docs/stable/connect/concurrency
2025-06-11 11:39:19,847 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 11:39:20,374 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-11 11:39:22,944 - __main__ - INFO - No power provider filter selected
2025-06-11 11:39:22,974 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 11:39:23,011 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 11:39:24,056 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 11:39:24,056 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-11 11:39:24,057 - parcel_filter.core.ranking - INFO - Created run directory: results/co_adams_20250611_113924
2025-06-11 11:39:24,085 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/co_adams_20250611_113924/weights_20250611_113924.json
2025-06-11 11:39:24,734 - pyogrio._io - INFO - Created 1,144 records
2025-06-11 11:39:24,739 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/co_adams_20250611_113924/co_adams_20250611_113924_ranked_parcels.gpkg
2025-06-11 11:39:31,807 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-11 11:39:31,808 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-11 11:39:31,808 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-11 11:39:31,808 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-06-11 11:39:31,813 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-11 11:39:31,814 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-06-11 11:39:31,814 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-06-11 11:39:31,814 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-06-11 11:39:31,814 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-06-11 11:39:31,814 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-06-11 11:39:31,814 - __main__ - INFO - Results saved in run_20250611_113924 directory
2025-06-11 11:45:43,087 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 11:45:43,324 - parcel_filter.core.filter - INFO - Found 12 unique power providers
2025-06-11 11:45:44,357 - __main__ - INFO - Selected power provider: Xcel
2025-06-11 11:45:44,389 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 11:45:44,427 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 11:45:45,151 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 11:45:45,151 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-11 11:45:45,151 - parcel_filter.core.ranking - INFO - Created run directory: results/co_adams_20250611_114545
2025-06-11 11:45:45,177 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/co_adams_20250611_114545/weights_20250611_114545.json
2025-06-11 11:45:45,372 - pyogrio._io - INFO - Created 1,144 records
2025-06-11 11:45:45,377 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/co_adams_20250611_114545/co_adams_20250611_114545_ranked_parcels.gpkg
2025-06-11 11:45:49,345 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-11 11:45:49,345 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-11 11:45:49,346 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-11 11:45:49,346 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-06-11 11:45:49,351 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-11 11:45:49,352 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-06-11 11:45:49,352 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-06-11 11:45:49,352 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-06-11 11:45:49,352 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-06-11 11:45:49,352 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-06-11 11:45:49,352 - __main__ - INFO - Results saved in co_adams_20250611_114549 directory
2025-06-11 12:11:45,816 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 12:11:46,030 - parcel_filter.core.filter - ERROR - Error getting power providers: Binder Error: Referenced column "power_provider" not found in FROM clause!
Candidate bindings: "owner", "previous_owner", "owner2", "owner4", "owner3"

LINE 4:                     WHERE power_provider IS NOT NULL
                                  ^
2025-06-11 12:11:46,034 - __main__ - ERROR - Error processing parcels: Binder Error: Referenced column "power_provider" not found in FROM clause!
Candidate bindings: "owner", "previous_owner", "owner2", "owner4", "owner3"

LINE 4:                     WHERE power_provider IS NOT NULL
                                  ^
2025-06-11 12:12:38,634 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 12:13:36,149 - __main__ - INFO - Selected power provider: Xcel Energy, Inc.
2025-06-11 12:13:36,183 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 12:13:36,220 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 12:13:36,807 - __main__ - ERROR - Error processing parcels: 'NoneType' object has no attribute 'calculate_rankings'
2025-06-11 12:14:32,445 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 12:14:34,828 - __main__ - INFO - Selected power provider: Xcel Energy, Inc.
2025-06-11 12:14:34,856 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 12:14:34,893 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 12:14:34,893 - __main__ - ERROR - Ranker not initialized. Please provide a ranking URL.
2025-06-11 12:15:47,330 - __main__ - ERROR - Error processing parcels: 'Namespace' object has no attribute 'update'
2025-06-11 12:22:17,951 - __main__ - ERROR - Error processing parcels: 'Namespace' object has no attribute 'update'
2025-06-11 12:23:11,677 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 12:23:19,641 - __main__ - INFO - Selected power provider: Xcel Energy, Inc.
2025-06-11 12:23:19,673 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 12:23:19,709 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 12:23:20,203 - __main__ - ERROR - Error processing parcels: 'NoneType' object has no attribute 'calculate_rankings'
2025-06-11 12:28:38,871 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 12:28:40,460 - __main__ - INFO - Selected power provider: Xcel Energy, Inc.
2025-06-11 12:28:40,489 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 12:28:40,524 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 12:28:41,420 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 12:28:41,420 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-11 12:28:41,420 - parcel_filter.core.ranking - INFO - Created run directory: results/co_adams_all_providers_20250611_122841
2025-06-11 12:28:41,945 - __main__ - ERROR - Error processing parcels: 'NoneType' object is not subscriptable
2025-06-11 12:31:09,484 - root - INFO - Virtual environment already exists. Skipping setup.
2025-06-11 12:31:11,093 - __main__ - INFO - Selected power provider: Xcel Energy, Inc.
2025-06-11 12:31:11,123 - parcel_filter.core.filter - INFO - Loading checkpoint: drive_times
2025-06-11 12:31:11,160 - __main__ - INFO - Loaded drive time checkpoint, skipping to ranking
2025-06-11 12:31:11,862 - parcel_filter.core.ranking - INFO - Successfully loaded ranking data with columns: ['zoning_type', 'Zoning Ranking', 'zoning_subtype', 'Zoning Subtype Ranking', 'lbcs_activity_desc', 'Land Activity Ranking', 'lbcs_site_desc', 'Site Descirption Ranking', 'lbcs_ownership_desc', 'Ownership Ranking', 'fema_nri_risk_ranking', 'Fema NRI Flood Risk Ranking', 'fema_flood_zone', 'Fema Flood Zone Ranking', 'fema_flood_zone_subtype', 'Fema Flood Zone Subtype Ranking']
2025-06-11 12:31:11,862 - parcel_filter.core.ranking - INFO - Loaded weights: {'zoning': 0.2, 'zoning_subtype': 0.1, 'activity': 0.1, 'site': 0.1, 'ownership': 0.1, 'fema_nri': 0.15, 'flood_zone': 0.1, 'flood_subtype': 0.1}
2025-06-11 12:31:11,862 - parcel_filter.core.ranking - INFO - Created run directory: results/co_adams_all_providers_20250611_123111
2025-06-11 12:31:11,889 - parcel_filter.core.ranking - INFO - Saved weights and rankings to results/co_adams_all_providers_20250611_123111/weights_20250611_123111.json
2025-06-11 12:31:12,150 - pyogrio._io - INFO - Created 1,144 records
2025-06-11 12:31:12,154 - parcel_filter.core.ranking - INFO - Saved ranked parcels to results/co_adams_all_providers_20250611_123111/co_adams_all_providers_20250611_123111_ranked_parcels.gpkg
2025-06-11 12:33:12,453 - parcel_filter.core.ranking - INFO - Ranking statistics:
2025-06-11 12:33:12,454 - parcel_filter.core.ranking - INFO -   Min score: 0.00
2025-06-11 12:33:12,454 - parcel_filter.core.ranking - INFO -   Max score: 10.00
2025-06-11 12:33:12,455 - parcel_filter.core.ranking - INFO -   Mean score: 4.52
2025-06-11 12:33:12,465 - parcel_filter.core.ranking - INFO - Top 5 parcels by ranking:
2025-06-11 12:33:12,467 - parcel_filter.core.ranking - INFO -   Parcel 0181100000040: Score 10.00
2025-06-11 12:33:12,467 - parcel_filter.core.ranking - INFO -   Parcel 0155500000069: Score 9.74
2025-06-11 12:33:12,467 - parcel_filter.core.ranking - INFO -   Parcel 0181335400005: Score 9.43
2025-06-11 12:33:12,467 - parcel_filter.core.ranking - INFO -   Parcel 0155703300002: Score 9.33
2025-06-11 12:33:12,467 - parcel_filter.core.ranking - INFO -   Parcel 0155500000020: Score 9.31
2025-06-11 12:33:12,467 - __main__ - INFO - Results saved in co_adams_all_providers_20250611_123312 directory
